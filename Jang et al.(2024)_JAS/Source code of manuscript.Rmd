---
title: 'JSDNE: a novel R package for estimating age quantitatively with the auricular
  surface by Dirichlet Normal Energy'
  
  
author: "Jisun Jang, Enrico Mariconti, Rebecca Watts"

date: "2024-06-01"
output:
  html_document:
    df_print: paged
editor_options:
  markdown:
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Abstract

Age estimation plays a significant role in forensic anthropology and 
bioarchaeology. However, widely-used traditional methods involving macroscopic 
observation suffer from subjectivity and statistical bias. The present research 
aims to minimize both issues by applying computational and mathematical 
approaches. A laser scanner was used to reconstruct 890 auricular surfaces of 
adult individuals from three known-age European skeletal collections. 
Dirichlet Normal Energy (DNE) was applied to assess the curvature of the 
auricular surface and its relationship with known age-at-death. Ten variables 
had high correlations, including total DNE per Total polygon faces, Mean value 
of DNE on apex, proportion of polygon faces with DNE of less than 0.0001 and 
proportion of polygon faces with DNE of over 0.6. The variables were used to 
develop age prediction models which are freely available in a novel R package, 
JSDNE. The package predicts age mathematically, objectively, and 
user-independently. It includes three functions: principal component quadratic
discriminant analysis (PCQDA), principal component regression analysis (PCR), 
and principal component logistic regression analysis (PCLR), which produce age 
estimates with 91%, 74%, and 92.9% levels of accuracy, respectively. 
JSDNE package (https://cran.r-project.org/package=JSDNE) can be downloaded 
automatically using install.packages("JSDNE"). The detailed code and the raw 
data developed the findings of this study are openly available 
at https://github.com/jisunjang19/cran-JSDNE or doi: 10.5281/zenodo.12708779.


### Introduction

Age estimation, together with sex and stature estimation, is crucial in 
constructing the biological profile of human remains. In bioarchaeology, the 
biological profile is the foundation for reconstructing past demographic 
information, leading to the proper understanding of human life history.
Forensic anthropology uses the biological profile to identify unknown 
individuals, helping to investigate cases of missing persons, mass disasters, 
genocide, and violent crime (Márquez-Grant, 2015; Moraitis et al., 2014; 
Rissech et al., 2012). With increased globalisation, natural disasters, 
and international terrorism, attention has been paid to developing more accurate 
and objective age estimation methods (Zhang et al., 2022). 
Age estimation methods have been developed based on observing bone changes 
that occur throughout life (Byers, 2007). These bone changes can be divided 
into developmental and degenerative changes (Moraitis et al., 2014); 
developmental changes are based on the maturation rate of bones, such as 
epiphyseal ossification (Schmeling et al., 2004), and tooth eruption 
(Kumar and Sridhar, 1990). These are used to estimate subadult age. As for 
adults who have completed growth, age is estimated by examining the degree 
of degenerative change (Schwartz, 1995), including the pubic symphysis 
(Brooks and Suchey, 1990), the sternal ends of the ribs (Işcan et al., 1984), 
and the auricular surface (Lovejoy et al., 1985). Among these, the auricular 
surface is considered one of the most significant indicators as it is dense, 
highly durable and often well-preserved against decomposition 
(Rivera-Sandoval et al., 2018). Moreover, it is argued that degenerative 
changes on the auricular surface continue after 60 years of age, making it 
possible to estimate older adults' age more accurately than other age 
indicators (Rissech et al., 2012). Even though age estimation methods have
been developed and revised over several decades, there is still no way to 
precisely interpret the speed and degree of change for different individuals.
This is because bone changes are affected by intrinsic and extrinsic factors, 
such as genes, diet, socioeconomics, and activity throughout the life, with
rates of change varying between individuals. Therefore, estimating adult age
can be complicated and inaccurate (Miranker, 2016). Age estimation methods 
traditionally suffer from two common issues: subjectivity and statistical bias. 
Most age estimation methods are based on visual assessment, which increases 
subjectivity. When assessing degenerative changes observers rely on their own 
expertise and experience to interpret the morphological features. Thus, the 
interpretation can differ depending on the observer, and the estimated result 
also varies. Even if the same observer assesses the same bone on different 
occasions, the results can be different. These are called interobserver and 
intraobserver errors, respectively (Garvin and Passalqua, 2011; 
Moraitis et al., 2014). Statistical bias occurs due to differences in the age
structure of the reference and target samples. Fundamentally, the estimated 
results for a target sample can be biased by the spread of ages of individuals 
that made up the reference sample. This is known as age structure mimicry 
(Mensforth, 1990:90). Regional and diachronic variations can also influence 
the degree of degeneration displayed by different morphological features, 
biasing results towards the reference sample and causing inaccurate and 
unreliable results. Overall, these issues impact the accuracy, reliability, 
reproducibility and repeatability of results. To address these limitations, 
more objective and less observer-dependent age estimation methods have been 
sought (Botha et al., 2019; Curate et al., 2022).
Recently, virtual anthropology has gained attention due to its potential to 
improve and revise traditional approaches through the application of 
computational imaging technology, such as computed tomography and laser 
scanning (Warrier et al., 2023). This allows a mathematical approach to 
extract subtle surface changes and more complex visual information not limited 
by human vision (Zhang et al., 2022; Warrier et al., 2023). It is also more 
user-independent, so the extracted results are objective, reproducible, and 
repeatable (Zhang et al., 2022). Currently, the most widely used mathematical 
approach in age estimation is curvature analysis of the joint surface. Curvature 
analysis is used to evaluate the degree to which surfaces are undulated or flat, 
and can therefore be used to analyse surface texture irregularities 
(Villa et al., 2015). To date, most research has focused on the pubic symphysis 
(Biwasaka et al., 2013; Stoyanova et al., 2015; Stoyanova et al., 2017; Slice 
and Agee-Hewitt, 2015), with only three papers exploring curvature analysis on 
the auricular surface (Jang et al., 2024; Štepanovský et al., 2023; 
Villa et al., 2015). Villa et al. (2015) used Gaussian curvature analysis to 
examine the correlations between five curvature variables and age: mean, 
highest, lowest, convex, and flat curvatures. The variables had moderate 
correlations with age, though it was noted that both young and older adults 
displayed high curvature values; young individuals because of transverse 
organisation, and older individuals due to increased macroporosity. Middle-aged 
individuals, who generally showed no transverse organisation or macroporosity 
(reflecting a flatter auricular surface), had lower curvature values. However, 
due to the sensitivity limitations of the equipment, detailed surface features 
such as surface texture and microporosity could not be analysed 
(Villa et al., 2015). While Villa et al. (2015) were able to show a correlation 
between curvature values and adult age, Štepanovský et al. (2023) developed this 
method further to produce age estimation software, CoxAGE3D, which uses an 
automatic data mining model. CoxAGE3D is fully automated, with age estimations 
produced after the user uploads a 3D laser scan of an auricular surface to the 
program. Calculations are based on multi-population auricular surfaces from five
known-age Asian and European collections, reducing statistical bias levels.
While this method appears to be able to identify a number of age-related 
coefficients, accuracy rates were not provided and it is yet to be subjected 
to independent validation. 
Jang et al. (2024) examined age-related change to the auricular surface using 
a different type of curvature analysis, Dirichlet Normal Energy (DNE). This 
requires a surface to be converted into polygon faces before DNE is used to 
measure how much the surface bends, which it does by quantifying the deviation 
of surface energy from a stable state, which is 0 or flat. Each polygon face (ρ) 
has two principal curvatures: the largest curvature (v) and the smallest 
curvature (υ), and the points at which these meet are called vertices 
(Figure 1). Each vertex has a normal (red arrow), which is the average value of 
the adjacent polygonal normal vectors (blue arrows). A polygon is formed by 
translating the normal vectors to a common vertex. This polygon has edge vectors 
(nν and nυ), which are derivatives of v and υ (Bunn et al., 2011; 
Pampush et al., 2016; Winchester, 2016). The Dirichlet Energy Density (DED) is 
obtained from the sum of square roots of edge vectors. Then, DNE is calculated 
as the total sum of the values multiplied by DNE and area 
(Pampush et al., 2016:398):


$$DED(\rho)=(n_v)^2(n_u)^2$$ $$DNE=\sum DED(\rho) \times area(\rho)$$

This makes it possible to identify subtle changes in surface curvature
more sensitively than other methods of curvature analysis (Bunn et al.,
2011; Godfrey et al., 2012). As Jang et al. (2024) tested this method on
archaeological skeletons with no biological information, age was
estimated using the Lovejoy (1985) and Buckberry-Chamberlain (2002)
methods. It was found that four DNE variables correlated with the
estimated age phases, those relating to surface undulation, apical
activity, macroporosity, and the total DNE per total number of polygon
faces. In terms of total DNE per total number of polygon faces, younger
adults had higher values than middle-aged adults due to the presence of
transverse organisation (surface undulation), which occurred more
frequently in the former. Younger adults had the highest DNE values for
surface undulation, with these values falling with increasing age.
Middle-aged adults had lower total DNE values because, as initially
noted by Villa et al. (2015), their auricular surfaces were flatter due
to a lack of transverse organisation or macroporosity. Older adults had
the highest total DNE values and the highest DNE values for
macroporosity and apical activity, which both showed a positive
correlation with age phase (Jang et al., 2024). Jang et al. (2024)
tested the levels of intraobserver error associated with this method and
found very high levels of agreement. However, there was still a degree
of user dependency as the user must manually select a region of interest
(ROI) before DNE values can be calculated (Jang et al., 2024). Moreover,
as this study used archaeological skeletons, the age of the individuals
was not documented, potentially obscuring relationships between DNE
values and age at death. To address these limitations, the current paper
builds on the work of Jang et al. (2024) by reducing the need to select
a ROI manually, and examining the relationship between DNE values and
age-at-death in known-age individuals. Age-related variables will be
identified via three statistical analysis methods: principal component
discriminant analysis (PCQDA), principal component regression analysis
(PCR), and principal component logistic regression analysis (PCLR). The
results have been used to develop an R package, JSDNE, which can be used
to estimate age-at-death in unknown individuals.


### Materials

Data for the current study was collected from three European anatomical
skeletal collections; the Luís Lopes Skeletal Collection, the 21st
Century Identified Skeletal Collection, and the CAL Milano Cemetery
Skeletal Collection. The Luís Lopes Skeletal Collection is curated by
the National Museum of Natural History and Science (MUHNAC), Lisbon,
Portugal. It contains 1,692 skeletons in total, with biographical
information available for 699 individuals, including age-at-death, place
of birth and residence, and cause of death. The remains were collected
from a modern cemetery in Lisbon between 19th and 20th centuries
(Cardoso, 2006). The 21st Century Identified Skeletal Collection is
curated by the University of Coimbra, Portugal. This contained 159 adult
individuals, ranging in age from 29 to 99 years at death. Most
individuals were Portuguese, dying between 1995 and 2008. Biographical
information, including sex and age-at-death, is available for the entire
collection, with documentation relating to the cause of death available
for 12 individuals (Ferreira et al., 2014). Lastly, the CAL Milano
Cemetery Skeletal Collection is curated by the Laboratorio di
Antropologia e Odontologia Forense (LABANOF) in the Department of
Biomedical Sciences for Health of the University of Milan (Italy) and
part of the Collezione Antropologica LABANOF (CAL), Italy. It contains
2127 skeletons from Cimitero Maggiore, Cimitero di Lambrate, and
Cimitero di Baggio. Biographical information, such as sex, age-at-death,
date of birth and death, cause of death, and pathology (if it is
specified), were all documented. The individuals died between 1910 and
2001, but most of them died after 1980 (Cattaneo et al., 2018). The
current research consists of 890 (402 females, 488 males) adult
individuals with a known age-at-death from these three collections
(Table 1 and Figure 2). All 890 individuals had fully preserved
auricular surfaces that displayed no taphonomic damage or pathological
conditions.

```{r, warning = FALSE, message = FALSE}
library(JSDNE)
data(RawData)
data(PCQDA_Test)
data(PCQDA_Train)
data(PCLR_Test)
data(PCLR_Train)
data(PCR_Test)
data(PCR_Train)
```

```{r, warning = FALSE, message = FALSE}
library(flextable)
library(tidyverse)
CollectionTable<-data.frame(table(RawData$Collection, RawData$Sex))
Female<-CollectionTable[1:3,3]
Male<-CollectionTable[4:6,3]
Var<-data.frame(as.character(CollectionTable[1:3,1]))
ColTable<-cbind(Var,Female,Male)
ColTable[,"Total"]=ColTable$Female+ColTable$Male
ColTable<-rbind(ColTable,"SumT")
ColTable[4,]=c("Total","402","488","890")
colnames(ColTable)=c("Collection","Female auricular surface","Male auricular surface","Total")
ColTable %>% flextable() %>% autofit()
```

Table 1. The number of auricular surfaces for each collection


```{r, warning = FALSE, message = FALSE}
library(tidyverse)
library(ggplot2)
library(extrafont)
df<-mutate(RawData, AgeGroup=case_when(Age>=20&Age<=29 ~ '20', Age>=30&Age<=39 ~ '30', 
                                       Age>=40&Age<=49 ~ '40', Age>=50&Age<=59 ~ '50', 
                                       Age>=60&Age<=69 ~ '60', Age>=70&Age<=79 ~ '70', 
                                       Age>=80 ~ 'Over 80', TRUE~'x'))
PreTable <-
  mutate(
    df,
    ColSex = case_when(
      Collection == '21st Century Identified Skeletal Collection' &
        Sex == 'Female' ~ 'Female_21st Century Identified Skeletal Collection',
      Collection == '21st Century Identified Skeletal Collection' &
        Sex == 'Male' ~ 'Male_21st Century Identified Skeletal Collection',
      Collection == 'CAL Milano Cemetery Skeletal Collection' &
        Sex == 'Female' ~ 'Female_CAL Milano Cemetery Skeletal Collection',
      Collection == 'CAL Milano Cemetery Skeletal Collection' &
        Sex == 'Male' ~ 'Male_CAL Milano Cemetery Skeletal Collection',
      Collection == 'Luis Lopes Skeletal Collection' &
        Sex == 'Female' ~ 'Female_Luis Lopes Skeletal Collection',
      Collection == 'Luis Lopes Skeletal Collection' &
        Sex == 'Male' ~ 'Male_Luis Lopes Skeletal Collection',
      TRUE ~ 'x'
    )
  )
df2<-subset(PreTable, select=c(AgeGroup, ColSex))
df2 <-
  transform(df2, ColSex = factor(
    ColSex,
    levels = c(
      'Female_21st Century Identified Skeletal Collection',
      'Male_21st Century Identified Skeletal Collection',
      'Female_CAL Milano Cemetery Skeletal Collection',
      'Male_CAL Milano Cemetery Skeletal Collection',
      'Female_Luis Lopes Skeletal Collection',
      'Male_Luis Lopes Skeletal Collection'
    )
  ))
ggplot(df2, aes(x = AgeGroup, fill = ColSex)) + geom_bar(position = 'dodge', colour =
                                                           "black") + guides(fill = guide_legend(nrow = 3)) + scale_fill_brewer(
                                                             palette = 1,
                                                             limits = c(
                                                               "Female_21st Century Identified Skeletal Collection",
                                                               "Female_CAL Milano Cemetery Skeletal Collection",
                                                               "Female_Luis Lopes Skeletal Collection",
                                                               "Male_21st Century Identified Skeletal Collection",
                                                               "Male_CAL Milano Cemetery Skeletal Collection",
                                                               "Male_Luis Lopes Skeletal Collection"
                                                             )
                                                           ) + geom_text(
                                                             stat = "count",
                                                             aes(label = ..count..),
                                                             position = position_dodge(width = 0.9),
                                                             vjust = -0.4,
                                                             size = 3
                                                           ) + theme(
                                                             legend.position = "bottom",
                                                             legend.text = element_text(size = 8),
                                                             axis.title.x = element_blank(),
                                                             axis.title.y = element_blank(),
                                                             legend.title = element_blank()
                                                           )
```

Figure 2. Distribution of the number of auricular surfaces according to
decade of age-at-death and sex


### Methods

#### Preparation and importing of reconstructed models 

Auricular surfaces
were scanned using an EXScan SP laser scanner (resolution: 1.3
megapixels). Each surface was scanned from a minimum of five different
angles and the resultant images were combined using the software
EXScanS_v3.1.0.1 to produce a single 3D model which was saved as a .ply
file. Each .ply file was then edited manually in Meshmixer to produce
two ROIs; the auricular surface and the apical area. The auricular
surface was isolated using the outer margin as a guide (following the
criterion of Jang et al., 2024). The apical area was delineated by
measuring polygons within a 1cm distance from both the left and right
sides of the terminated point of the arcuate line. The 3D models were
imported into R studio with the vcgPlyRead function from Rvcg package
(Schlager, 2015).

#### Analysis 

Principal component analysis (PCA), quadratic discriminant
analysis (PCDQA), and regression analysis (PCLR) were used to identify
DNE variables that were highly correlated with known age-at-death. These
correlations were then used to develop a model that estimates an unknown
auricular surface's age-at-death. In order to make this model available
to other researchers, an R package, JSDNE, was created, which requires R
version 4.3.2 (R Core Team, 2024). JSDNE can be installed automatically
by operating the install function, install.packages("JSDNE"). Once the
package is installed, it can be imported by the library function,
library(JSDNE). Four packages are automatically imported to the user's
library: dplyr (Wickham et al., 2019), MASS (Venables and Ripley, 2002),
molaR (Pampush et al., 2016), and nnet (Venables and Ripley, 2002).
After importing the .ply files with the vcgPlyRead function, the
auricular surface .ply file should be replaced with x and the apical
area with y. If oppositely applied, incorrect results will be
calculated. The JSDNE package consists of three functions to estimate
age (Table 2). The PCQDA function can assign an individual to one of
four broad age ranges (Table 4). The PCR function provides an output of
estimated age in years and the standard error. The PCLR function also
assigns an individual to a broad age range, but with a more limited
range of under 67 years or over 63 years.

```{r, warning = FALSE, message = FALSE}
Function<-c("","PCQDA(x,y)","","","PCR(x,y)","","","PCLR(x,y)", "")
Description <-
  c(
    "Estimates the age phase through the PCQDA analysis",
    "x: whole auricular surface, y: apex",
    "Output: estimated age phase and age range ",
    "Estimates the age through the PCR analysis",
    "x: whole auricular surface, y: apex",
    "Output: estimated age and standard error (8.8 yrs) ",
    "Estimates the age phase through the PCLR analysis",
    "x: whole auricular surface, y: apex",
    "Output: estimated age phase and age range "
  )
DesTable<-data.frame(Function,Description)
DesTable%>%flextable()%>%autofit()%>%hline(i = 3, part = "body")%>%hline(i = 6, part = "body")
```

Table 2. Function in the JSDNE package


### Results

#### Age-related variables 

Initial analyses identified ten DNE variables that
were highly correlated with age-at-death in the known-age sample (Table
3 and Figure 3). Nine of these variables (total DNE per total number of
polygon faces, median value of DNE on whole surface, interquartile range
(IQR) on whole surface, mean value of DNE on convex and concave
surfaces, proportion of polygon faces with DNE of over 0.6, and mean,
median and IQR of DNE on apex) had high positive correlations, while the
proportion of polygon faces with DNE of less than 0.0001, had a high
negative correlation.

```{r, warning = FALSE, message = FALSE}
library(corrtable)
Variables<-subset(RawData,select=-c(Collection,Sex,Cluster1,Cluster2))
cor<-data.frame(correlation_matrix(Variables, digits=3,replace_diagonal = TRUE))
CorTable<-subset(cor,select=c(Age.))
CorTable[, 2] <-
  c(
    " ",
    "High positive correlation",
    "High positive correlation",
    "High positive correlation",
    "High positive correlation",
    "High positive correlation",
    "High positive correlation",
    "High positive correlation",
    "High positive correlation",
    "High negative correlation",
    "High positive correlation"
  )
CorTable<-CorTable[-1,]
rownames(CorTable) = c(
  "Mean value of DNE on apex",
  "Median value of DNE on apex",
  "IQR of DNE on apex",
  "Total DNE per total polygon faces",
  "Median value of DNE on whole surface",
  "IQR of DNE on whole surface",
  "Mean value of DNE on convex surface",
  "Mean value of DNE on concave surface",
  "Proportion of polygon faces with DNE of less than 0.0001",
  "Proportion of polygon faces with DNE of over 0.6"
)
CorTable<-cbind(rownames(CorTable), data.frame(CorTable, row.names=NULL))
colnames(CorTable)=c("Variables","Pearson's correlation r-value","Interpretation")
CorTable%>%flextable()%>%autofit()
```

Table 3. Pearson's correlation for ten DNE variables and known
age-at-death. \*\*\* means p-value is under 0.0001.


```{r, warning = FALSE, message = FALSE, fig.height = 10}
library(ggpubr)
g1 <-
  ggplot(data = Variables) + geom_point(aes(x = Age, y = MeanDNE.Apex)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                        "none") + scale_x_continuous(limit = c(20, 100))
g2 <-
  ggplot(data = Variables) + geom_point(aes(x = Age, y = MedianDNE.Apex)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                          "none") + scale_x_continuous(limit = c(20, 100))
g3 <-
  ggplot(data = Variables) + geom_point(aes(x = Age, y = IQRDNE.Apex)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                       "none") + scale_x_continuous(limit = c(20, 100))
g4 <-
  ggplot(data = Variables) + geom_point(aes(x = Age, y = TotalDNE.TotalPolygonFaces)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                                      "none") + scale_x_continuous(limit = c(20, 100))
g5 <-
  ggplot(data = Variables) + geom_point(aes(x = Age, y = MedianDNE.Whole)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                           "none") + scale_x_continuous(limit = c(20, 100))
g6 <-
  ggplot(data = Variables) + geom_point(aes(x = Age, y = IQRDNE.Whole)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                        "none") + scale_x_continuous(limit = c(20, 100))
g7 <-
  ggplot(data = Variables) + geom_point(aes(x = Age, y = MeanDNE.Convex)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                          "none") + scale_x_continuous(limit = c(20, 100))
g8 <-
  ggplot(data = Variables) + geom_point(aes(x = Age, y = MeanDNE.Concave)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                           "none") + scale_x_continuous(limit = c(20, 100))
g9 <-
  ggplot(data = Variables) + geom_point(aes(x = Age, y = Proportion.DNEunder0.0001)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                                     "none") + scale_x_continuous(limit = c(20, 100))
g10 <-
  ggplot(data = Variables) + geom_point(aes(x = Age, y = Proportion.DNEover0.6)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                                 "none") + scale_x_continuous(limit = c(20, 100))

ggarrange(g1,g2,g3,g4,g5,g6,g7,g8,g9,g10, labels = c("(a)", "(b)","(c)","(d)","(e)","(f)","(g)","(h)","(i)","(j)"), hjust=0.05, ncol = 2, nrow = 5)
```

Figure 3. Correlation graphs of each 10 DNE variables with age: (a) Mean
value of DNE on apex; (b) Median value of DNE on apex; (c) IQR of DNE on
apex; (d) Total DNE per Total polygon faces; (e) Median value of DNE on
whole surface; (f) IQR of DNE on whole surface; (g) Mean value of DNE on
convex surface; (h) Mean value of DNE on concave surface; (i) Proportion
of polygon faces with DNE of less than 0.0001; (j) Proportion of polygon
faces with DNE of over 0.6


#### Identifying the suitable variables and the cluster 

The best combination of variables was chosen on the basis of three criteria: 
(1) high total accuracy, (2) high accuracy in younger auricular surfaces and 
older auricular surfaces, and (3) low bias. For PCR analysis, an additional 
criterion was used: low standard error. For the PCQDA analysis, four variables 
provided the best combination: proportion of polygon faces with DNE of less 
than 0.0001, proportion of polygon faces with DNE of over 0.6, mean value of 
DNE on apex, and total DNE/total polygon faces. Grouping estimated ages into 
four age phases (Table 4 and Figure 4). The age intervals of each phase are 
24 years (phase 1), 43 years (phase 2) and 30 years (phase 3), with an 
open-ended phase 4. For PCR analysis, seven variables provided the best 
combination: total DNE per total number of polygon faces, mean value of DNE on 
apex, IQR value of DNE on apex, mean value of DNE on convex surface, proportion 
of polygon faces with DNE of less than 0.0001. As this is a regression model 
no age phase was produced. Instead, the output provides an estimated age in 
years with a standard error of ±8.8 yrs. Finally, the PCLR analysis was 
developed using five variables: total DNE per total number of polygon faces, 
median value of DNE on whole surface, IQR of DNE on whole surface, mean value 
of DNE on convex surface, and mean value of DNE on apex. Estimated age was 
divided into two phases to determine if the auricular surface is under 67 years 
or over 63 years (Table 5 and Figure 5). The age phases for each of the three 
types of analysis were designated in order of the lowest minimum value of the 
age range. The minimum values of age phases 1,2,3 and 4 in PCQDA were 20,31,63 
and 76, respectively, and minimum values of age phases 1 and 2 in PCLR were 20 
and 63, respectively. When converting the variables to principal components, 
the first and second principal components contained 98%, 96%, and 96% 
information in PCQDA, PCLR, and PCR methods, respectively. Thus, the first 
and second principal components were used as variables. Then, the statistical 
models were developed using cross-validation. The training and test sets 
contained 80% and 20% of the data set randomly.

```{r, warning = FALSE, message = FALSE}
D1<-round(aggregate(RawData[,1], list(RawData$Cluster2), mean),2)
D2<-aggregate(RawData[,1], list(RawData$Cluster2), median)
D3<-aggregate(RawData[,1], list(RawData$Cluster2), min)
D4<-aggregate(RawData[,1], list(RawData$Cluster2), max)
D5<-data.frame(D1$Group.1,D3$x,D4$x,D1$x,D2$x)
colnames(D5)=c("Age phase","Min","Max","Mean","Median")
D5%>%flextable()%>%autofit()
```

Table 4. Age range, mean, median values of each age phase of PCQDA


```{r, warning = FALSE, message = FALSE, fig.height = 3}
ggplot(data = RawData) + geom_point(aes(x = Age, y = Cluster2)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                "none") + scale_x_continuous(limit = c(20, 100)) + scale_y_continuous(limit =
                                                                                                                                                                        c(0.5, 4.5))
```

Figure 4. Distribution graph of each age phase of PCQDA


```{r, warning = FALSE, message = FALSE}
DR1<-round(aggregate(RawData[,1], list(RawData$Cluster1), mean),2)
DR2<-aggregate(RawData[,1], list(RawData$Cluster1), median)
DR3<-aggregate(RawData[,1], list(RawData$Cluster1), min)
DR4<-aggregate(RawData[,1], list(RawData$Cluster1), max)
DR5<-data.frame(DR1$Group.1,DR3$x,DR4$x,DR1$x,DR2$x)
colnames(DR5)=c("Age phase","Min","Max","Mean","Median")
DR5%>%flextable()%>%autofit()
```

Table 5. Age range, mean, median values of each age phase of PCLR


```{r, warning = FALSE, message = FALSE, fig.height = 3}
ggplot(data = RawData) + geom_point(aes(x = Age, y = Cluster1)) + xlab("") + ylab("") + theme(legend.position =
                                                                                                "none") + scale_x_continuous(limit = c(20, 100)) + scale_y_continuous(limits = c(0.5, 2.5),
                                                                                                                                                                      labels = c(' ', '1', ' ', '2', ' '))
```

Figure 5. Distribution graph of each age phase of PCLR


### Accuracy, bias, and the average absolute deviation of the JSDNE age

#### PCQDA 

The training set, test set, and combined set showed similar
results. Accordingly, the results were described based on the combined
set. Accuracy was defined as JSDNE age estimates that fell within the
age phase that contained the known age-at-death. Bias was calculated as
the mean value of the subtracted values between the mean age of the
estimated age phase and the known age at death. The average absolute
deviation (AAD) was the mean value of the absolute values subtracted
between the mean age of the estimated age phase and the known age at
death:

$$Bias=\sum(mean \ age \ of \ the \ estimated \ age \ phase - known \ age \ at \ death)/N$$
$$AAD=\sum|mean \ age \ of \ the \ estimated \ age \ phase - known \ age \ at \ death|/N$$

The total accuracy and the average absolute deviation (AAD) are 91% and 
9.58 years, respectively (Table 6). This demonstrates that the PCQDA function 
estimates age with a high level of accuracy and precision. Phase 2, which 
estimated individuals to be over 31 and under 74 years of age, had the lowest 
accuracy (88.8%) and the highest AAD (11.52 years). The highest accuracy and 
the lowest AAD were shown in phase 1 (20-44 years of age), with 97.8% and 
5.53 years, respectively. While the cluster analysis identified this four-phase 
grouping system as the best fit for the prediction model, levels of accuracy 
were also examined using 10-year age intervals (Table 7), in order to compare 
the relative applicability of each of the functions across age cohorts. This 
showed that there was a tendency to underestimate the age of older individuals 
(those in their 60s and older) and overestimate the age of younger and middle 
aged individuals (in their 50s and younger). Individuals in their 20s were 
estimated with the lowest level of accuracy (65.9%). The highest AAD 
(94.9 years) was in their 30s. The highest accuracy levels were seen for 
individuals estimated to be in their 40s (98.2%).

```{r, warning = FALSE, message = FALSE}
PCQDA_data <-
  subset(
    RawData,
    select = c(
      Cluster2,
      Age,
      MeanDNE.Apex,
      TotalDNE.TotalPolygonFaces,
      Proportion.DNEunder0.0001,
      Proportion.DNEover0.6
    )
  )
model_PCQDA <- subset(PCQDA_Train, select = -c(Cluster2, Age))
PCQDA_df <- scale(model_PCQDA)
PCQDA_df.pca <- prcomp(PCQDA_df)
PCQDA_pca <- PCQDA_df.pca$x[, 1:2]
PCQDA_df2 <- data.frame(Cluster = PCQDA_Train$Cluster2, PCQDA_pca)
PCQDA <- MASS::qda(Cluster ~ ., data = PCQDA_df2)
```

```{r, warning = FALSE, message = FALSE}
PCQDA_Bind <- subset(PCQDA_Test, select = -c(Cluster2, Age))
PCQDA_scale_Bind <- scale(PCQDA_Bind)
PCQDA_Bind_est.pca.x <-
  as.matrix(PCQDA_scale_Bind) %*% PCQDA_df.pca$rotation
PCQDA_Bind_est <- data.frame(PCQDA_Bind_est.pca.x)
PCQDA_est <- PCQDA_Bind_est[, 1:2]
PCQDA_pred <- predict(PCQDA, PCQDA_est, type = "class")
PCQDA_Estimated <- PCQDA_pred$class
PCQDA_result <- data.frame(PCQDA_Estimated, PCQDA_Test$Age)
```

```{r, warning = FALSE, message = FALSE}
PCQDA_result <-
  dplyr::mutate(
    PCQDA_result,
    MinAge = dplyr::case_when(
      PCQDA_Estimated == 1 ~ '20',
      PCQDA_Estimated == 2 ~ '31',
      PCQDA_Estimated == 3 ~ '63',
      PCQDA_Estimated == 4 ~ '76',
      TRUE ~ 'x'
    )
  )
PCQDA_result <-
  dplyr::mutate(
    PCQDA_result,
    MaxAge = dplyr::case_when(
      PCQDA_Estimated == 1 ~ '44',
      PCQDA_Estimated == 2 ~ '74',
      PCQDA_Estimated == 3 ~ '93',
      PCQDA_Estimated == 4 ~ '99',
      TRUE ~ 'x'
    )
  )
PCQDA_result <-
  dplyr::mutate(
    PCQDA_result,
    Mean = dplyr::case_when(
      PCQDA_Estimated == 1 ~ '25.75',
      PCQDA_Estimated == 2 ~ '54.09',
      PCQDA_Estimated == 3 ~ '78.57',
      PCQDA_Estimated == 4 ~ '86.56',
      TRUE ~ 'x'
    )
  )
PCQDA_result <-
  dplyr::mutate(
    PCQDA_result,
    Accuracy = dplyr::case_when(PCQDA_Test.Age <= MaxAge &
                                  PCQDA_Test.Age >= MinAge ~ 'o', TRUE ~ 'x')
  )
PCQDA_result <-
  dplyr::mutate(
    PCQDA_result,
    AgeCohort = dplyr::case_when(
      PCQDA_Test.Age <= 29 &
        PCQDA_Test.Age >= 20 ~ 20,
      PCQDA_Test.Age <= 39 &
        PCQDA_Test.Age >= 30 ~ 30,
      PCQDA_Test.Age <= 49 &
        PCQDA_Test.Age >= 40 ~ 40,
      PCQDA_Test.Age <= 59 &
        PCQDA_Test.Age >= 50 ~ 50,
      PCQDA_Test.Age <= 69 &
        PCQDA_Test.Age >= 60 ~ 60,
      PCQDA_Test.Age <= 79 &
        PCQDA_Test.Age >= 70 ~ 70,
      PCQDA_Test.Age >= 80 ~ 80,
      TRUE ~ NA_real_
    )
  )
```

```{r, warning = FALSE, message = FALSE}
Total_Test <-
  data.frame(round(prop.table(table(
    PCQDA_result$Accuracy
  )) * 100, 1))
Test_Ac1 <-
  data.frame(round(prop.table(
    table(PCQDA_result$PCQDA_Estimated, PCQDA_result$Accuracy),
    1
  ) * 100, 1))
Total_Test2 <- rbind(Total_Test[1, ], Test_Ac1[1:4, -2])
BTest <- data.frame(as.numeric(PCQDA_result$Mean))
BTest[, 2] <-
  BTest$as.numeric.PCQDA_result.Mean. - PCQDA_result$PCQDA_Test.Age
Estimated <- data.frame(as.numeric(PCQDA_result$PCQDA_Estimated))
BTable <- cbind(BTest, PCQDA_result$PCQDA_Test.Age, Estimated)
BTable[, 5] = abs(BTable$V2)
names(BTable) = c("Mean", "Bias", "Age", "phase", "ABS")
BiasTable <- round(aggregate(BTable[, 2], list(BTable$phase), mean), 2)
ABSTable <- round(aggregate(BTable[, 5], list(BTable$phase), mean), 2)
TotalBias <- data.frame("Total", round(mean(BTable$Bias), 2))
names(TotalBias) = c("Group.1", "x")
TotalABS <- data.frame("Total", round(mean(BTable$ABS), 2))
names(TotalABS) = c("Group.1", "x")
TotalABS2 <- rbind(TotalABS, ABSTable)
TotalBias2 <- rbind(TotalBias, BiasTable)
Total_Test3 <- cbind(Total_Test2, TotalBias2, TotalABS2)
Total_Test3 <- subset(Total_Test3, select = -c(Group.1))
Total_Test3 <- subset(Total_Test3, select = -c(Group.1))
Total_Test3[, 1] = c("Total", "Phase 1", "Phase 2", "Phase 3", "Phase 4")
names(Total_Test3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
Train_pca<-data.frame(PCQDA_pca)
Train_PCQDA_pred<-predict(PCQDA, Train_pca,type="class")
Train_PCQDA_Estimated <- Train_PCQDA_pred$class
Train_PCQDA_result<-data.frame(Train_PCQDA_Estimated, PCQDA_Train$Age)
```

```{r, warning = FALSE, message = FALSE}
Train_PCQDA_result <-
  dplyr::mutate(
    Train_PCQDA_result,
    MinAge = dplyr::case_when(
      Train_PCQDA_Estimated == 1 ~ '20',
      Train_PCQDA_Estimated == 2 ~ '31',
      Train_PCQDA_Estimated == 3 ~ '63',
      Train_PCQDA_Estimated == 4 ~ '76',
      TRUE ~ 'x'
    )
  )
Train_PCQDA_result <-
  dplyr::mutate(
    Train_PCQDA_result,
    MaxAge = dplyr::case_when(
      Train_PCQDA_Estimated == 1 ~ '44',
      Train_PCQDA_Estimated == 2 ~ '74',
      Train_PCQDA_Estimated == 3 ~ '93',
      Train_PCQDA_Estimated == 4 ~ '99',
      TRUE ~ 'x'
    )
  )
Train_PCQDA_result <-
  dplyr::mutate(
    Train_PCQDA_result,
    Mean = dplyr::case_when(
      Train_PCQDA_Estimated == 1 ~ '25.75',
      Train_PCQDA_Estimated == 2 ~ '54.09',
      Train_PCQDA_Estimated == 3 ~ '78.57',
      Train_PCQDA_Estimated == 4 ~ '86.56',
      TRUE ~ 'x'
    )
  )
Train_PCQDA_result <-
  dplyr::mutate(
    Train_PCQDA_result,
    Accuracy = dplyr::case_when(
      PCQDA_Train.Age <= MaxAge &
        PCQDA_Train.Age >= MinAge ~ 'o',
      TRUE ~ 'x'
    )
  )
Train_PCQDA_result <-
  dplyr::mutate(
    Train_PCQDA_result,
    AgeCohort = dplyr::case_when(
      PCQDA_Train.Age <= 29 &
        PCQDA_Train.Age >= 20 ~ 20,
      PCQDA_Train.Age <= 39 &
        PCQDA_Train.Age >= 30 ~ 30,
      PCQDA_Train.Age <= 49 &
        PCQDA_Train.Age >= 40 ~ 40,
      PCQDA_Train.Age <= 59 &
        PCQDA_Train.Age >= 50 ~ 50,
      PCQDA_Train.Age <= 69 &
        PCQDA_Train.Age >= 60 ~ 60,
      PCQDA_Train.Age <= 79 &
        PCQDA_Train.Age >= 70 ~ 70,
      PCQDA_Train.Age >= 80 ~ 80,
      TRUE ~ NA_real_
    )
  )
```

```{r, warning = FALSE, message = FALSE}
Total_Train <-
  data.frame(round(prop.table(table(
    Train_PCQDA_result$Accuracy
  )) * 100, 1))
Train_Ac1 <-
  data.frame(round(prop.table(
    table(
      Train_PCQDA_result$Train_PCQDA_Estimated,
      Train_PCQDA_result$Accuracy
    ),
    1
  ) * 100, 1))
Total_Train2 <- rbind(Total_Train[1, ], Train_Ac1[1:4, -2])
BTrain <- data.frame(as.numeric(Train_PCQDA_result$Mean))
BTrain[, 2] <-
  BTrain$as.numeric.Train_PCQDA_result.Mean. - Train_PCQDA_result$PCQDA_Train.Age
Estimated <-
  data.frame(as.numeric(Train_PCQDA_result$Train_PCQDA_Estimated))
Train_BTable <-
  cbind(BTrain, Train_PCQDA_result$PCQDA_Train.Age, Estimated)
Train_BTable[, 5] = abs(Train_BTable$V2)
names(Train_BTable) = c("Mean", "Bias", "Age", "phase", "ABS")
Train_BiasTable <-
  round(aggregate(Train_BTable[, 2], list(Train_BTable$phase), mean), 2)
Train_ABSTable <-
  round(aggregate(Train_BTable[, 5], list(Train_BTable$phase), mean), 2)
Train_TotalBias <-
  data.frame("Total", round(mean(Train_BTable$Bias), 2))
names(Train_TotalBias) = c("Group.1", "x")
Train_TotalABS <- data.frame("Total", round(mean(Train_BTable$ABS), 2))
names(Train_TotalABS) = c("Group.1", "x")
Train_TotalABS2 <- rbind(Train_TotalABS, Train_ABSTable)
Train_TotalBias2 <- rbind(Train_TotalBias, Train_BiasTable)
Train_Total_Test3 <-
  cbind(Total_Train2, Train_TotalBias2, Train_TotalABS2)
Train_Total_Test3 <- subset(Train_Total_Test3, select = -c(Group.1))
Train_Total_Test3 <- subset(Train_Total_Test3, select = -c(Group.1))
Train_Total_Test3[, 1] = c("Total", "Phase 1", "Phase 2", "Phase 3", "Phase 4")
names(Train_Total_Test3) = c("", "Acc.", "Bias", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
Total_PCQDA <- subset(PCQDA_data, select = -c(Cluster2, Age))
PCQDA_scale_Total <- scale(Total_PCQDA)
PCQDA_Total_est.pca.x <-
  as.matrix(PCQDA_scale_Total) %*% PCQDA_df.pca$rotation
PCQDA_Total_est <- data.frame(PCQDA_Total_est.pca.x)
PCQDA_Total_est <- PCQDA_Total_est[, 1:2]
Total_PCQDA_pred <- predict(PCQDA, PCQDA_Total_est, type = "class")
Total_PCQDA_Estimated <- Total_PCQDA_pred$class
Total_PCQDA_result <-
  data.frame(Total_PCQDA_Estimated, PCQDA_data$Age)
```

```{r, warning = FALSE, message = FALSE}
Total_PCQDA_result <-
  dplyr::mutate(
    Total_PCQDA_result,
    MinAge = dplyr::case_when(
      Total_PCQDA_Estimated == 1 ~ '20',
      Total_PCQDA_Estimated == 2 ~ '31',
      Total_PCQDA_Estimated == 3 ~ '63',
      Total_PCQDA_Estimated == 4 ~ '76',
      TRUE ~ 'x'
    )
  )
Total_PCQDA_result <-
  dplyr::mutate(
    Total_PCQDA_result,
    MaxAge = dplyr::case_when(
      Total_PCQDA_Estimated == 1 ~ '44',
      Total_PCQDA_Estimated == 2 ~ '74',
      Total_PCQDA_Estimated == 3 ~ '93',
      Total_PCQDA_Estimated == 4 ~ '99',
      TRUE ~ 'x'
    )
  )
Total_PCQDA_result <-
  dplyr::mutate(
    Total_PCQDA_result,
    Mean = dplyr::case_when(
      Total_PCQDA_Estimated == 1 ~ '25.75',
      Total_PCQDA_Estimated == 2 ~ '54.09',
      Total_PCQDA_Estimated == 3 ~ '78.57',
      Total_PCQDA_Estimated == 4 ~ '86.56',
      TRUE ~ 'x'
    )
  )
Total_PCQDA_result <-
  dplyr::mutate(
    Total_PCQDA_result,
    Accuracy = dplyr::case_when(PCQDA_data.Age <= MaxAge &
                                  PCQDA_data.Age >= MinAge ~ 'o', TRUE ~ 'x')
  )
Total_PCQDA_result <-
  dplyr::mutate(
    Total_PCQDA_result,
    AgeCohort = dplyr::case_when(
      PCQDA_data.Age <= 29 &
        PCQDA_data.Age >= 20 ~ 20,
      PCQDA_data.Age <= 39 &
        PCQDA_data.Age >= 30 ~ 30,
      PCQDA_data.Age <= 49 &
        PCQDA_data.Age >= 40 ~ 40,
      PCQDA_data.Age <= 59 &
        PCQDA_data.Age >= 50 ~ 50,
      PCQDA_data.Age <= 69 &
        PCQDA_data.Age >= 60 ~ 60,
      PCQDA_data.Age <= 79 &
        PCQDA_data.Age >= 70 ~ 70,
      PCQDA_data.Age >= 80 ~ 80,
      TRUE ~ NA_real_
    )
  )
```

```{r, warning = FALSE, message = FALSE}
Total_Total <-
  data.frame(round(prop.table(table(
    Total_PCQDA_result$Accuracy
  )) * 100, 1))
Total_Ac1 <-
  data.frame(round(prop.table(
    table(
      Total_PCQDA_result$Total_PCQDA_Estimated,
      Total_PCQDA_result$Accuracy
    ),
    1
  ) * 100, 1))
Total_Total2 <- rbind(Total_Total[1, ], Total_Ac1[1:4, -2])
BTotal <- data.frame(as.numeric(Total_PCQDA_result$Mean))
BTotal[, 2] <-
  BTotal$as.numeric.Total_PCQDA_result.Mean. - Total_PCQDA_result$PCQDA_data.Age
Estimated <-
  data.frame(as.numeric(Total_PCQDA_result$Total_PCQDA_Estimated))
Total_BTable <-
  cbind(BTotal, Total_PCQDA_result$PCQDA_data.Age, Estimated)
Total_BTable[, 5] = abs(Total_BTable$V2)
names(Total_BTable) = c("Mean", "Bias", "Age", "phase", "ABS")
Total_BiasTable <-
  round(aggregate(Total_BTable[, 2], list(Total_BTable$phase), mean), 2)
Total_ABSTable <-
  round(aggregate(Total_BTable[, 5], list(Total_BTable$phase), mean), 2)
Total_TotalBias <-
  data.frame("Total", round(mean(Total_BTable$Bias), 2))
names(Total_TotalBias) = c("Group.1", "x")
Total_TotalABS <- data.frame("Total", round(mean(Total_BTable$ABS), 2))
names(Total_TotalABS) = c("Group.1", "x")
Total_TotalABS2 <- rbind(Total_TotalABS, Total_ABSTable)
Total_TotalBias2 <- rbind(Total_TotalBias, Total_BiasTable)
Total_Total_Test3 <-
  cbind(Total_Total2, Total_TotalBias2, Total_TotalABS2)
Total_Total_Test3 <- subset(Total_Total_Test3, select = -c(Group.1))
Total_Total_Test3 <- subset(Total_Total_Test3, select = -c(Group.1))
Total_Total_Test3[, 1] = c("Total", "Phase 1", "Phase 2", "Phase 3", "Phase 4")
names(Total_Total_Test3) = c("", "Acc.", "Bias", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
PCQDA_result_Table <-
  cbind(Total_Test3, Train_Total_Test3, Total_Total_Test3)
PCQDA_result_Table <-
  subset(PCQDA_result_Table, select = -c(Var.5, Var.9))
PCQDA_result_Table %>% flextable() %>% autofit() %>% add_header_row(
  values = c(
    " ",
    "ACC.",
    "Bias",
    "AAD.",
    "ACC.",
    "Bias",
    "AAD.",
    "ACC.",
    "Bias",
    "AAD."
  ),
  top = FALSE
) %>% theme_box() %>% delete_rows(i = 1, part = "header") %>% add_header_row(
  values = c(" ", "Test set", "Train set", "Combined set"),
  colwidths = c(1, 3, 3, 3),
  top = TRUE
) %>% align(align = "left", part = "header")
```

Table 6. PCQDA results of each age phase. Acc. = Accuracy, AAD. =
Average absolute deviation (Year), Accuracy is in percent (%) and Bias,
AAD are in years


```{r, warning = FALSE, message = FALSE}
Total_Test <-
  data.frame(round(prop.table(table(
    PCQDA_result$Accuracy
  )) * 100, 1))
C_Test_Ac1 <-
  data.frame(round(prop.table(
    table(PCQDA_result$AgeCohort, PCQDA_result$Accuracy), 1
  ) * 100, 1))
C_Total_Test2 <- rbind(Total_Test[1, ], C_Test_Ac1[1:7, -2])
BTest <- data.frame(as.numeric(PCQDA_result$Mean))
BTest[, 2] <-
  BTest$as.numeric.PCQDA_result.Mean. - PCQDA_result$PCQDA_Test.Age
C_BTable <- cbind(BTest, PCQDA_result$AgeCohort)
C_BTable[, 4] = abs(C_BTable$V2)
names(C_BTable) = c("Mean", "Bias", "Cohort", "ABS")
C_BiasTable <-
  round(aggregate(C_BTable[, 2], list(C_BTable$Cohort), mean), 2)
C_ABSTable <-
  round(aggregate(C_BTable[, 4], list(C_BTable$Cohort), mean), 2)
C_TotalBias <- data.frame("Total", round(mean(C_BTable$Bias), 2))
names(C_TotalBias) = c("Group.1", "x")
C_TotalABS <- data.frame("Total", round(mean(C_BTable$ABS), 2))
names(C_TotalABS) = c("Group.1", "x")
C_TotalABS2 <- rbind(C_TotalABS, C_ABSTable)
C_TotalBias2 <- rbind(C_TotalBias, C_BiasTable)
C_Total_Test3 <- cbind(C_Total_Test2, C_TotalBias2, C_TotalABS2)
C_Total_Test3 <- subset(C_Total_Test3, select = -c(Group.1))
C_Total_Test3 <- subset(C_Total_Test3, select = -c(Group.1))
C_Total_Test3[, 1] = c("Total", "20s", "30s", "40s", "50s", "60s", "70s", "Over80")
names(C_Total_Test3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
Train_Total_Test <-
  data.frame(round(prop.table(table(
    Train_PCQDA_result$Accuracy
  )) * 100, 1))
C_Train_Ac1 <-
  data.frame(round(prop.table(
    table(Train_PCQDA_result$AgeCohort, Train_PCQDA_result$Accuracy),
    1
  ) * 100, 1))
C_Total_Train2 <- rbind(Total_Train[1, ], C_Train_Ac1[1:7, -2])
BTrain <- data.frame(as.numeric(Train_PCQDA_result$Mean))
BTrain[, 2] <-
  BTrain$as.numeric.Train_PCQDA_result.Mean. - Train_PCQDA_result$PCQDA_Train.Age
C_Train_BTable <- cbind(BTrain, Train_PCQDA_result$AgeCohort)
C_Train_BTable[, 4] = abs(C_Train_BTable$V2)
names(C_Train_BTable) = c("Mean", "Bias", "Cohort", "ABS")
C_Train_BiasTable <-
  round(aggregate(C_Train_BTable[, 2], list(C_Train_BTable$Cohort), mean), 2)
C_Train_ABSTable <-
  round(aggregate(C_Train_BTable[, 4], list(C_Train_BTable$Cohort), mean), 2)
C_Train_TotalBias <-
  data.frame("Total", round(mean(C_Train_BTable$Bias), 2))
names(C_Train_TotalBias) = c("Group.1", "x")
C_Train_TotalABS <-
  data.frame("Total", round(mean(C_Train_BTable$ABS), 2))
names(C_Train_TotalABS) = c("Group.1", "x")
C_Train_TotalABS2 <- rbind(C_Train_TotalABS, C_Train_ABSTable)
C_Train_TotalBias2 <- rbind(C_Train_TotalBias, C_Train_BiasTable)
C_Total_Train3 <-
  cbind(C_Total_Train2, C_Train_TotalBias2, C_Train_TotalABS2)
C_Total_Train3 <- subset(C_Total_Train3, select = -c(Group.1))
C_Total_Train3 <- subset(C_Total_Train3, select = -c(Group.1))
C_Total_Train3[, 1] = c("Total", "20s", "30s", "40s", "50s", "60s", "70s", "Over80")
names(C_Total_Train3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
Total_Total_Test <-
  data.frame(round(prop.table(table(
    Total_PCQDA_result$Accuracy
  )) * 100, 1))
C_Total_Ac1 <-
  data.frame(round(prop.table(
    table(Total_PCQDA_result$AgeCohort, Total_PCQDA_result$Accuracy),
    1
  ) * 100, 1))
C_Total_Total2 <- rbind(Total_Total[1, ], C_Total_Ac1[1:7, -2])
BTotal <- data.frame(as.numeric(Total_PCQDA_result$Mean))
BTotal[, 2] <-
  BTotal$as.numeric.Total_PCQDA_result.Mean. - Total_PCQDA_result$PCQDA_data.Age
C_Total_BTable <- cbind(BTotal, Total_PCQDA_result$AgeCohort)
C_Total_BTable[, 4] = abs(C_Total_BTable$V2)
names(C_Total_BTable) = c("Mean", "Bias", "Cohort", "ABS")
C_Total_BiasTable <-
  round(aggregate(C_Total_BTable[, 2], list(C_Total_BTable$Cohort), mean), 2)
C_Total_ABSTable <-
  round(aggregate(C_Total_BTable[, 4], list(C_Total_BTable$Cohort), mean), 2)
C_Total_TotalBias <-
  data.frame("Total", round(mean(C_Total_BTable$Bias), 2))
names(C_Total_TotalBias) = c("Group.1", "x")
C_Total_TotalABS <-
  data.frame("Total", round(mean(C_Total_BTable$ABS), 2))
names(C_Total_TotalABS) = c("Group.1", "x")
C_Total_TotalABS2 <- rbind(C_Total_TotalABS, C_Total_ABSTable)
C_Total_TotalBias2 <- rbind(C_Total_TotalBias, C_Total_BiasTable)
C_Total_Total3 <-
  cbind(C_Total_Total2, C_Total_TotalBias2, C_Total_TotalABS2)
C_Total_Total3 <- subset(C_Total_Total3, select = -c(Group.1))
C_Total_Total3 <- subset(C_Total_Total3, select = -c(Group.1))
C_Total_Total3[, 1] = c("Total", "20s", "30s", "40s", "50s", "60s", "70s", "Over80")
names(C_Total_Total3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
C_PCQDA_result_Table <-
  cbind(C_Total_Test3, C_Total_Train3, C_Total_Total3)
C_PCQDA_result_Table <-
  subset(C_PCQDA_result_Table, select = -c(Var.5, Var.9))
C_PCQDA_result_Table %>% flextable() %>% autofit() %>% add_header_row(
  values = c(
    " ",
    "ACC.",
    "Bias",
    "AAD.",
    "ACC.",
    "Bias",
    "AAD.",
    "ACC.",
    "Bias",
    "AAD."
  ),
  top = FALSE
) %>% theme_box() %>% delete_rows(i = 1, part = "header") %>% add_header_row(
  values = c(" ", "Test set", "Train set", "Combined set"),
  colwidths = c(1, 3, 3, 3),
  top = TRUE
) %>% align(align = "left", part = "header")
```

Table 7. PCQDA results within 10-year intervals. Acc. = Accuracy, AAD. =
Average absolute deviation (Year), Accuracy is in percent (%) and Bias,
AAD are in years


#### PCR 

PCR Accuracy was defined as JSDNE age estimates that fell within the standard
error (8.8yrs) of the known age-at-death. The total accuracy and ADD are 76% 
and 6.46 years, respectively (Table 8). When collated into 10-year age intervals, 
the accuracy levels range from poor to moderate, but this is due to the high 
precision of the age estimate in the majority of intervals. Individuals in 
their 20s and over 80 were predicted with the lowest levels of accuracy (52.4% 
and 56.3%), and highest levels of AAD (9.37 years and 9.4 years). The highest 
accuracy (92.2%) was found for individuals estimated to be in their 50s. As 
with the PCQDA function, there was a tendency for younger and middle aged adults 
(those in their 40s and younger) to be overestimated, while the age of 
individuals over 50 was underestimated.

```{r, warning = FALSE, message = FALSE}
PCR_data <-
  subset(
    RawData,
    select = c(
      Age,
      MeanDNE.Apex,
      IQRDNE.Apex,
      TotalDNE.TotalPolygonFaces,
      MeanDNE.Convex,
      Proportion.DNEunder0.0001
    )
  )
model_PCR <- subset(PCR_Train , select = -c(Age))
PCR_df <- scale(model_PCR)
PCR_df.pca <- prcomp(PCR_df)
PCR_pca <- PCR_df.pca$x[, 1:2]
PCR_df2 <- data.frame(Age = PCR_Train$Age, PCR_pca)
PCR <- lm(Age ~ ., data = PCR_df2)
PCR_Bind <- subset(PCR_Test, select = -c(Age))
PCR_scale_Bind <- scale(PCR_Bind)
PCR_Bind_est.pca.x <-
  as.matrix(PCR_scale_Bind) %*% PCR_df.pca$rotation
PCR_Bind_est <- data.frame(PCR_Bind_est.pca.x)
PCR_est <- PCR_Bind_est[, 1:2]
PCR_pred <- predict(PCR, PCR_est)
PCR_result <- data.frame(PCR_pred, PCR_Test$Age)
```

```{r, warning = FALSE, message = FALSE}
KK=length(PCR$coefficients)-1
SSE=sum(PCR$residuals**2)
NK=length(PCR$residuals)
sqrt(SSE/(NK-(1+KK)))
```

```{r, warning = FALSE, message = FALSE}
PCR_result[, "MinAge"] = PCR_result$PCR_pred - 8.8
PCR_result[, "MaxAge"] = PCR_result$PCR_pred + 8.8
PCR_result <-
  dplyr::mutate(
    PCR_result,
    Accuracy = dplyr::case_when(PCR_Test.Age <= MaxAge &
                                  PCR_Test.Age >= MinAge ~ 'o', TRUE ~ 'x')
  )
PCR_result <-
  dplyr::mutate(
    PCR_result,
    AgeCohort = dplyr::case_when(
      PCR_Test.Age <= 29 &
        PCR_Test.Age >= 20 ~ 20,
      PCR_Test.Age <= 39 &
        PCR_Test.Age >= 30 ~ 30,
      PCR_Test.Age <= 49 &
        PCR_Test.Age >= 40 ~ 40,
      PCR_Test.Age <= 59 &
        PCR_Test.Age >= 50 ~ 50,
      PCR_Test.Age <= 69 &
        PCR_Test.Age >= 60 ~ 60,
      PCR_Test.Age <= 79 &
        PCR_Test.Age >= 70 ~ 70,
      PCR_Test.Age >= 80 ~ 80,
      TRUE ~ NA_real_
    )
  )
```

```{r, warning = FALSE, message = FALSE}
PC_Total_Test <-
  data.frame(round(prop.table(table(
    PCR_result$Accuracy
  )) * 100, 1))
PC_Test_Ac1 <-
  data.frame(round(prop.table(
    table(PCR_result$AgeCohort, PCR_result$Accuracy), 1
  ) * 100, 1))
PC_Total_Test2 <- rbind(PC_Total_Test[1, ], PC_Test_Ac1[1:7, -2])
PC_BTable <-
  data.frame(PCR_result$PCR_pred - PCR_result$PCR_Test.Age,
             PCR_result$AgeCohort)
names(PC_BTable) = c("Bias", "Cohort")
PC_BTable[, "ABS"] = abs(PC_BTable$Bias)
PC_BiasTable <-
  round(aggregate(PC_BTable[, 1], list(PC_BTable$Cohort), mean), 2)
PC_ABSTable <-
  round(aggregate(PC_BTable[, 3], list(PC_BTable$Cohort), mean), 2)
PC_TotalBias <- data.frame("Total", round(mean(PC_BTable$Bias), 2))
names(PC_TotalBias) = c("Group.1", "x")
PC_TotalABS <- data.frame("Total", round(mean(PC_BTable$ABS), 2))
names(PC_TotalABS) = c("Group.1", "x")
PC_TotalABS2 <- rbind(PC_TotalABS, PC_ABSTable)
PC_TotalBias2 <- rbind(PC_TotalBias, PC_BiasTable)
PC_Total_Test3 <- cbind(PC_Total_Test2, PC_TotalBias2, PC_TotalABS2)
PC_Total_Test3 <- subset(PC_Total_Test3, select = -c(Group.1))
PC_Total_Test3 <- subset(PC_Total_Test3, select = -c(Group.1))
PC_Total_Test3[, 1] = c("Total", "20s", "30s", "40s", "50s", "60s", "70s", "Over80")
names(PC_Total_Test3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
Train_PCR_est <- data.frame(PCR_pca)
Train_PCR_pred <- predict(PCR, Train_PCR_est)
Train_PCR_result <- data.frame(Train_PCR_pred, PCR_Train$Age)

Train_PCR_result[, "MinAge"] = Train_PCR_result$Train_PCR_pred - 8.8
Train_PCR_result[, "MaxAge"] = Train_PCR_result$Train_PCR_pred + 8.8
Train_PCR_result <-
  dplyr::mutate(
    Train_PCR_result,
    Accuracy = dplyr::case_when(PCR_Train.Age <= MaxAge &
                                  PCR_Train.Age >= MinAge ~ 'o', TRUE ~ 'x')
  )
Train_PCR_result <-
  dplyr::mutate(
    Train_PCR_result,
    AgeCohort = dplyr::case_when(
      PCR_Train.Age <= 29 &
        PCR_Train.Age >= 20 ~ 20,
      PCR_Train.Age <= 39 &
        PCR_Train.Age >= 30 ~ 30,
      PCR_Train.Age <= 49 &
        PCR_Train.Age >= 40 ~ 40,
      PCR_Train.Age <= 59 &
        PCR_Train.Age >= 50 ~ 50,
      PCR_Train.Age <= 69 &
        PCR_Train.Age >= 60 ~ 60,
      PCR_Train.Age <= 79 &
        PCR_Train.Age >= 70 ~ 70,
      PCR_Train.Age >= 80 ~ 80,
      TRUE ~ NA_real_
    )
  )
```

```{r, warning = FALSE, message = FALSE}
PC_Total_Train <-
  data.frame(round(prop.table(table(
    Train_PCR_result$Accuracy
  )) * 100, 1))
PC_Train_Ac1 <-
  data.frame(round(prop.table(
    table(Train_PCR_result$AgeCohort, Train_PCR_result$Accuracy),
    1
  ) * 100, 1))
PC_Total_Train2 <- rbind(PC_Total_Train[1, ], PC_Train_Ac1[1:7, -2])
Train_PC_BTable <-
  data.frame(
    Train_PCR_result$Train_PCR_pred - Train_PCR_result$PCR_Train.Age,
    Train_PCR_result$AgeCohort
  )
names(Train_PC_BTable) = c("Bias", "Cohort")
Train_PC_BTable[, "ABS"] = abs(Train_PC_BTable$Bias)
Train_PC_BiasTable <-
  round(aggregate(Train_PC_BTable[, 1], list(Train_PC_BTable$Cohort), mean), 2)
Train_PC_ABSTable <-
  round(aggregate(Train_PC_BTable[, 3], list(Train_PC_BTable$Cohort), mean), 2)
Train_PC_TotalBias <-
  data.frame("Total", round(mean(Train_PC_BTable$Bias), 2))
names(Train_PC_TotalBias) = c("Group.1", "x")
Train_PC_TotalABS <-
  data.frame("Total", round(mean(Train_PC_BTable$ABS), 2))
names(Train_PC_TotalABS) = c("Group.1", "x")
Train_PC_TotalABS2 <- rbind(Train_PC_TotalABS, Train_PC_ABSTable)
Train_PC_TotalBias2 <- rbind(Train_PC_TotalBias, Train_PC_BiasTable)
PC_Total_Train3 <-
  cbind(PC_Total_Train2, Train_PC_TotalBias2, Train_PC_TotalABS2)
PC_Total_Train3 <- subset(PC_Total_Train3, select = -c(Group.1))
PC_Total_Train3 <- subset(PC_Total_Train3, select = -c(Group.1))
PC_Total_Train3[, 1] = c("Total", "20s", "30s", "40s", "50s", "60s", "70s", "Over80")
names(PC_Total_Train3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
Total_PCR_Bind <- subset(PCR_data, select = -c(Age))
Total_PCR_scale_Bind <- scale(Total_PCR_Bind)
Total_PCR_Bind_est.pca.x <-
  as.matrix(Total_PCR_scale_Bind) %*% PCR_df.pca$rotation
Total_PCR_Bind_est <- data.frame(Total_PCR_Bind_est.pca.x)
Total_PCR_est <- Total_PCR_Bind_est[, 1:2]
Total_PCR_pred <- predict(PCR, Total_PCR_est)
Total_PCR_result <- data.frame(Total_PCR_pred, PCR_data$Age)
```

```{r, warning = FALSE, message = FALSE}
Total_PCR_result[, "MinAge"] = Total_PCR_result$Total_PCR_pred - 8.8
Total_PCR_result[, "MaxAge"] = Total_PCR_result$Total_PCR_pred + 8.8
Total_PCR_result <-
  dplyr::mutate(
    Total_PCR_result,
    Accuracy = dplyr::case_when(PCR_data.Age <= MaxAge &
                                  PCR_data.Age >= MinAge ~ 'o', TRUE ~ 'x')
  )
Total_PCR_result <-
  dplyr::mutate(
    Total_PCR_result,
    AgeCohort = dplyr::case_when(
      PCR_data.Age <= 29 &
        PCR_data.Age >= 20 ~ 20,
      PCR_data.Age <= 39 &
        PCR_data.Age >= 30 ~ 30,
      PCR_data.Age <= 49 &
        PCR_data.Age >= 40 ~ 40,
      PCR_data.Age <= 59 &
        PCR_data.Age >= 50 ~ 50,
      PCR_data.Age <= 69 &
        PCR_data.Age >= 60 ~ 60,
      PCR_data.Age <= 79 &
        PCR_data.Age >= 70 ~ 70,
      PCR_data.Age >= 80 ~ 80,
      TRUE ~ NA_real_
    )
  )
```

```{r, warning = FALSE, message = FALSE}
PC_Total_Total <-
  data.frame(round(prop.table(table(
    Total_PCR_result$Accuracy
  )) * 100, 1))
PC_Total_Ac1 <-
  data.frame(round(prop.table(
    table(Total_PCR_result$AgeCohort, Total_PCR_result$Accuracy),
    1
  ) * 100, 1))
PC_Total_Total2 <- rbind(PC_Total_Total[1, ], PC_Total_Ac1[1:7, -2])

Total_PC_BTable <-
  data.frame(
    Total_PCR_result$Total_PCR_pred - Total_PCR_result$PCR_data.Age,
    Total_PCR_result$AgeCohort
  )
names(Total_PC_BTable) = c("Bias", "Cohort")
Total_PC_BTable[, "ABS"] = abs(Total_PC_BTable$Bias)
Total_PC_BiasTable <-
  round(aggregate(Total_PC_BTable[, 1], list(Total_PC_BTable$Cohort), mean), 2)
Total_PC_ABSTable <-
  round(aggregate(Total_PC_BTable[, 3], list(Total_PC_BTable$Cohort), mean), 2)
Total_PC_TotalBias <-
  data.frame("Total", round(mean(Total_PC_BTable$Bias), 2))
names(Total_PC_TotalBias) = c("Group.1", "x")
Total_PC_TotalABS <-
  data.frame("Total", round(mean(Total_PC_BTable$ABS), 2))
names(Total_PC_TotalABS) = c("Group.1", "x")
Total_PC_TotalABS2 <- rbind(Total_PC_TotalABS, Total_PC_ABSTable)
Total_PC_TotalBias2 <- rbind(Total_PC_TotalBias, Total_PC_BiasTable)
PC_Total_Total3 <-
  cbind(PC_Total_Total2, Total_PC_TotalBias2, Total_PC_TotalABS2)
PC_Total_Total3 <- subset(PC_Total_Total3, select = -c(Group.1))
PC_Total_Total3 <- subset(PC_Total_Total3, select = -c(Group.1))
PC_Total_Total3[, 1] = c("Total", "20s", "30s", "40s", "50s", "60s", "70s", "Over80")
names(PC_Total_Total3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
library(flextable)
PC_PCR_result_Table <-
  cbind(PC_Total_Test3, PC_Total_Train3, PC_Total_Total3)
PC_PCR_result_Table <-
  subset(PC_PCR_result_Table, select = -c(Var.5, Var.9))
PC_PCR_result_Table %>% flextable() %>% autofit() %>% add_header_row(
  values = c(
    " ",
    "ACC.",
    "Bias",
    "AAD.",
    "ACC.",
    "Bias",
    "AAD.",
    "ACC.",
    "Bias",
    "AAD."
  ),
  top = FALSE
) %>% theme_box() %>% delete_rows(i = 1, part = "header") %>% add_header_row(
  values = c(" ", "Test set", "Train set", "Combined set"),
  colwidths = c(1, 3, 3, 3),
  top = TRUE
) %>% align(align = "left", part = "header")
```

Table 8. PCR results (SE: 8.8 yrs) were obtained within 10-year
intervals. Acc. = Accuracy, AAD. = Average absolute deviation (Year),
Accuracy is in percent (%) and Bias, AAD are in years


#### PCLR 

Accuracy was defined as JSDNE age estimates that fell within the age phase that 
contained the known age-at-death. PCLR produced a high level of accuracy overall 
(92.9%), and high precision (9.93 years) (Table 9). Phase 1 has higher accuracy 
(95.2%) than phase 2 (90.2%). However, phase 2 has higher precision than 
phase 1, indicated by the lower AAD value (11.48 years vs. 8.09 years). When 
classifying individuals with 10-year age intervals (Table 10), the highest 
accuracy was shown for individuals in their 30s (100%), and the lowest accuracy 
for individuals in their 60s (80.6%). In terms of precision, individuals in 20s 
had the lowest precision (ADD: 20.45 years), and those in their 40s had the 
highest precision (ADD: 2.68 years). Yet again, individuals under 40 years of 
age tended to be overestimated, while individuals over 40 were underestimated.

```{r, warning = FALSE, message = FALSE}
PCLR_data <-
  subset(
    RawData,
    select = c(
      Age,
      Cluster1,
      MeanDNE.Apex,
      TotalDNE.TotalPolygonFaces,
      MedianDNE.Whole,
      IQRDNE.Whole,
      MeanDNE.Convex
    )
  )
model_PCLR <- subset(PCLR_Train, select = -c(Cluster1, Age))
PCLR_df <- scale(model_PCLR)
PCLR_df.pca <- prcomp(PCLR_df)
PCLR_pca <- PCLR_df.pca$x[, 1:2]
PCLR_df2 <- data.frame(Cluster = PCLR_Train$Cluster1, PCLR_pca)
PCLR <- nnet::multinom(Cluster ~ ., data = PCLR_df2)
PCLR_Bind <- subset(PCLR_Test, select = -c(Cluster1, Age))
PCLR_scale_Bind <- scale(PCLR_Bind)
PCLR_Bind_est.pca.x <-
  as.matrix(PCLR_scale_Bind) %*% PCLR_df.pca$rotation
PCLR_Bind_est <- data.frame(PCLR_Bind_est.pca.x)
PCLR_est <- PCLR_Bind_est[, 1:2]
PCLR_pred <- predict(PCLR, PCLR_est, type = "class")
PCLR_result <- data.frame(PCLR_pred, PCLR_Test$Age)
```

```{r, warning = FALSE, message = FALSE}
PCLR_result <-
  dplyr::mutate(PCLR_result,
                MinAge = dplyr::case_when(PCLR_pred == 1 ~ '20', PCLR_pred == 2 ~ '63', TRUE ~
                                            'x'))
PCLR_result <-
  dplyr::mutate(PCLR_result,
                MaxAge = dplyr::case_when(PCLR_pred == 1 ~ '67', PCLR_pred == 2 ~ '99', TRUE ~
                                            'x'))
PCLR_result <-
  dplyr::mutate(
    PCLR_result,
    AgeCohort = dplyr::case_when(
      PCLR_Test.Age <= 29 &
        PCLR_Test.Age >= 20 ~ 20,
      PCLR_Test.Age <= 39 &
        PCLR_Test.Age >= 30 ~ 30,
      PCLR_Test.Age <= 49 &
        PCLR_Test.Age >= 40 ~ 40,
      PCLR_Test.Age <= 59 &
        PCLR_Test.Age >= 50 ~ 50,
      PCLR_Test.Age <= 69 &
        PCLR_Test.Age >= 60 ~ 60,
      PCLR_Test.Age <= 79 &
        PCLR_Test.Age >= 70 ~ 70,
      PCLR_Test.Age >= 80 ~ 80,
      TRUE ~ NA_real_
    )
  )
PCLR_result <-
  dplyr::mutate(
    PCLR_result,
    Mean = dplyr::case_when(PCLR_pred == 1 ~ '44.29', PCLR_pred == 2 ~ '75.68', TRUE ~
                              'x')
  )
PCLR_result <-
  dplyr::mutate(
    PCLR_result,
    Accuracy = dplyr::case_when(PCLR_Test.Age <= MaxAge &
                                  PCLR_Test.Age >= MinAge ~ 'o', TRUE ~ 'x')
  )
```

```{r, warning = FALSE, message = FALSE}
LR_Total_Test <-
  data.frame(round(prop.table(table(
    PCLR_result$Accuracy
  )) * 100, 1))
LR_Test_Ac1 <-
  data.frame(round(prop.table(
    table(PCLR_result$PCLR_pred, PCLR_result$Accuracy), 1
  ) * 100, 1))
LR_Total_Test2 <- rbind(LR_Total_Test[1, ], LR_Test_Ac1[1:2, -2])
LR_BTest <- data.frame(as.numeric(PCLR_result$Mean))
LR_BTest[, 2] <-
  LR_BTest$as.numeric.PCLR_result.Mean. - PCLR_result$PCLR_Test.Age
LR_Estimated <- data.frame(as.numeric(PCLR_result$PCLR_pred))
LR_BTable <- cbind(LR_BTest, PCLR_result$PCLR_Test.Age, LR_Estimated)
LR_BTable[, 5] = abs(LR_BTable$V2)
names(LR_BTable) = c("Mean", "Bias", "Age", "phase", "ABS")
LR_BiasTable <-
  round(aggregate(LR_BTable[, 2], list(LR_BTable$phase), mean), 2)
LR_ABSTable <-
  round(aggregate(LR_BTable[, 5], list(LR_BTable$phase), mean), 2)
LR_TotalBias <- data.frame("Total", round(mean(LR_BTable$Bias), 2))
names(LR_TotalBias) = c("Group.1", "x")
LR_TotalABS <- data.frame("Total", round(mean(LR_BTable$ABS), 2))
names(LR_TotalABS) = c("Group.1", "x")
LR_TotalABS2 <- rbind(LR_TotalABS, LR_ABSTable)
LR_TotalBias2 <- rbind(LR_TotalBias, LR_BiasTable)
LR_Total_Test3 <- cbind(LR_Total_Test2, LR_TotalBias2, LR_TotalABS2)
LR_Total_Test3 <- subset(LR_Total_Test3, select = -c(Group.1))
LR_Total_Test3 <- subset(LR_Total_Test3, select = -c(Group.1))
LR_Total_Test3[, 1] = c("Total", "Phase 1", "Phase 2")
names(LR_Total_Test3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
Train_pca<-data.frame(PCLR_pca)
Train_PCLR_pred<-predict(PCLR, Train_pca,type="class")
Train_PCLR_result<-data.frame(Train_PCLR_pred, PCLR_Train$Age)
```

```{r, warning = FALSE, message = FALSE}
Train_PCLR_result <-
  dplyr::mutate(
    Train_PCLR_result,
    MinAge = dplyr::case_when(Train_PCLR_pred == 1 ~ '20', Train_PCLR_pred == 2 ~ '63', TRUE ~
                                'x')
  )
Train_PCLR_result <-
  dplyr::mutate(
    Train_PCLR_result,
    MaxAge = dplyr::case_when(Train_PCLR_pred == 1 ~ '67', Train_PCLR_pred == 2 ~ '99', TRUE ~
                                'x')
  )
Train_PCLR_result <-
  dplyr::mutate(
    Train_PCLR_result,
    Mean = dplyr::case_when(
      Train_PCLR_pred == 1 ~ '44.29',
      Train_PCLR_pred == 2 ~ '75.68',
      TRUE ~ 'x'
    )
  )
Train_PCLR_result <-
  dplyr::mutate(
    Train_PCLR_result,
    Accuracy = dplyr::case_when(PCLR_Train.Age <= MaxAge &
                                  PCLR_Train.Age >= MinAge ~ 'o', TRUE ~ 'x')
  )
Train_PCLR_result <-
  dplyr::mutate(
    Train_PCLR_result,
    AgeCohort = dplyr::case_when(
      PCLR_Train.Age <= 29 &
        PCLR_Train.Age >= 20 ~ 20,
      PCLR_Train.Age <= 39 &
        PCLR_Train.Age >= 30 ~ 30,
      PCLR_Train.Age <= 49 &
        PCLR_Train.Age >= 40 ~ 40,
      PCLR_Train.Age <= 59 &
        PCLR_Train.Age >= 50 ~ 50,
      PCLR_Train.Age <= 69 &
        PCLR_Train.Age >= 60 ~ 60,
      PCLR_Train.Age <= 79 &
        PCLR_Train.Age >= 70 ~ 70,
      PCLR_Train.Age >= 80 ~ 80,
      TRUE ~ NA_real_
    )
  )
```

```{r, warning = FALSE, message = FALSE}
LR_Total_Train <-
  data.frame(round(prop.table(table(
    Train_PCLR_result$Accuracy
  )) * 100, 1))
LR_Train_Ac1 <-
  data.frame(round(prop.table(
    table(
      Train_PCLR_result$Train_PCLR_pred,
      Train_PCLR_result$Accuracy
    ),
    1
  ) * 100, 1))
LR_Total_Train2 <- rbind(LR_Total_Train[1, ], LR_Train_Ac1[1:2, -2])
LR_BTrain <- data.frame(as.numeric(Train_PCLR_result$Mean))
LR_BTrain[, 2] <-
  LR_BTrain$as.numeric.Train_PCLR_result.Mean. - Train_PCLR_result$PCLR_Train.Age
LR_Estimated <-
  data.frame(as.numeric(Train_PCLR_result$Train_PCLR_pred))
LR_BTable <-
  cbind(LR_BTrain, Train_PCLR_result$PCLR_Train.Age, LR_Estimated)
LR_BTable[, 5] = abs(LR_BTable$V2)
names(LR_BTable) = c("Mean", "Bias", "Age", "phase", "ABS")
LR_BiasTable <-
  round(aggregate(LR_BTable[, 2], list(LR_BTable$phase), mean), 2)
LR_ABSTable <-
  round(aggregate(LR_BTable[, 5], list(LR_BTable$phase), mean), 2)
LR_TotalBias <- data.frame("Total", round(mean(LR_BTable$Bias), 2))
names(LR_TotalBias) = c("Group.1", "x")
LR_TotalABS <- data.frame("Total", round(mean(LR_BTable$ABS), 2))
names(LR_TotalABS) = c("Group.1", "x")
LR_TotalABS2 <- rbind(LR_TotalABS, LR_ABSTable)
LR_TotalBias2 <- rbind(LR_TotalBias, LR_BiasTable)
LR_Total_Train3 <- cbind(LR_Total_Train2, LR_TotalBias2, LR_TotalABS2)
LR_Total_Train3 <- subset(LR_Total_Train3, select = -c(Group.1))
LR_Total_Train3 <- subset(LR_Total_Train3, select = -c(Group.1))
LR_Total_Train3[, 1] = c("Total", "Phase 1", "Phase 2")
names(LR_Total_Train3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
Total_PCLR_Bind <- subset(PCLR_data, select = -c(Cluster1, Age))
Total_PCLR_scale_Bind <- scale(Total_PCLR_Bind)
Total_PCLR_Bind_est.pca.x <-
  as.matrix(Total_PCLR_scale_Bind) %*% PCLR_df.pca$rotation
Total_PCLR_Bind_est <- data.frame(Total_PCLR_Bind_est.pca.x)
Total_PCLR_est <- Total_PCLR_Bind_est[, 1:2]
Total_PCLR_pred <- predict(PCLR, Total_PCLR_est, type = "class")
Total_PCLR_result <- data.frame(Total_PCLR_pred, PCLR_data$Age)
```

```{r, warning = FALSE, message = FALSE}
Total_PCLR_result <-
  dplyr::mutate(
    Total_PCLR_result,
    MinAge = dplyr::case_when(Total_PCLR_pred == 1 ~ '20', Total_PCLR_pred == 2 ~ '63', TRUE ~
                                'x')
  )
Total_PCLR_result <-
  dplyr::mutate(
    Total_PCLR_result,
    MaxAge = dplyr::case_when(Total_PCLR_pred == 1 ~ '67', Total_PCLR_pred == 2 ~ '99', TRUE ~
                                'x')
  )
Total_PCLR_result <-
  dplyr::mutate(
    Total_PCLR_result,
    Mean = dplyr::case_when(
      Total_PCLR_pred == 1 ~ '44.29',
      Total_PCLR_pred == 2 ~ '75.68',
      TRUE ~ 'x'
    )
  )
Total_PCLR_result <-
  dplyr::mutate(
    Total_PCLR_result,
    Accuracy = dplyr::case_when(PCLR_data.Age <= MaxAge &
                                  PCLR_data >= MinAge ~ 'o', TRUE ~ 'x')
  )
Total_PCLR_result <-
  dplyr::mutate(
    Total_PCLR_result,
    AgeCohort = dplyr::case_when(
      PCLR_data <= 29 &
        PCLR_data >= 20 ~ 20,
      PCLR_data <= 39 &
        PCLR_data >= 30 ~ 30,
      PCLR_data <= 49 &
        PCLR_data >= 40 ~ 40,
      PCLR_data <= 59 &
        PCLR_data >= 50 ~ 50,
      PCLR_data <= 69 &
        PCLR_data >= 60 ~ 60,
      PCLR_data <= 79 &
        PCLR_data >= 70 ~ 70,
      PCLR_data >= 80 ~ 80,
      TRUE ~ NA_real_
    )
  )
```

```{r, warning = FALSE, message = FALSE}
LR_Total_Total <-
  data.frame(round(prop.table(table(
    Total_PCLR_result$Accuracy
  )) * 100, 1))
LR_Total_Ac1 <-
  data.frame(round(prop.table(
    table(
      Total_PCLR_result$Total_PCLR_pred,
      Total_PCLR_result$Accuracy
    ),
    1
  ) * 100, 1))
LR_Total_Total2 <- rbind(LR_Total_Total[1, ], LR_Total_Ac1[1:2, -2])
LR_BTotal <- data.frame(as.numeric(Total_PCLR_result$Mean))
LR_BTotal[, 2] <-
  LR_BTotal$as.numeric.Total_PCLR_result.Mean. - Total_PCLR_result$PCLR_data.Age
LR_Estimated <-
  data.frame(as.numeric(Total_PCLR_result$Total_PCLR_pred))
LR_BTable <-
  cbind(LR_BTotal, Total_PCLR_result$PCLR_data.Age, LR_Estimated)
LR_BTable[, 5] = abs(LR_BTable$V2)
names(LR_BTable) = c("Mean", "Bias", "Age", "phase", "ABS")
LR_BiasTable <-
  round(aggregate(LR_BTable[, 2], list(LR_BTable$phase), mean), 2)
LR_ABSTable <-
  round(aggregate(LR_BTable[, 5], list(LR_BTable$phase), mean), 2)
LR_TotalBias <- data.frame("Total", round(mean(LR_BTable$Bias), 2))
names(LR_TotalBias) = c("Group.1", "x")
LR_TotalABS <- data.frame("Total", round(mean(LR_BTable$ABS), 2))
names(LR_TotalABS) = c("Group.1", "x")
LR_TotalABS2 <- rbind(LR_TotalABS, LR_ABSTable)
LR_TotalBias2 <- rbind(LR_TotalBias, LR_BiasTable)
LR_Total_Total3 <- cbind(LR_Total_Total2, LR_TotalBias2, LR_TotalABS2)
LR_Total_Total3 <- subset(LR_Total_Total3, select = -c(Group.1))
LR_Total_Total3 <- subset(LR_Total_Total3, select = -c(Group.1))
LR_Total_Total3[, 1] = c("Total", "Phase 1", "Phase 2")
names(LR_Total_Total3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
LR_PCLR_result_Table <-
  cbind(LR_Total_Test3, LR_Total_Train3, LR_Total_Total3)
LR_PCLR_result_Table <-
  subset(LR_PCLR_result_Table, select = -c(Var.5, Var.9))
LR_PCLR_result_Table %>% flextable() %>% autofit() %>% add_header_row(
  values = c(
    " ",
    "ACC.",
    "Bias",
    "AAD.",
    "ACC.",
    "Bias",
    "AAD.",
    "ACC.",
    "Bias",
    "AAD."
  ),
  top = FALSE
) %>% theme_box() %>% delete_rows(i = 1, part = "header") %>% add_header_row(
  values = c(" ", "Test set", "Train set", "Combined set"),
  colwidths = c(1, 3, 3, 3),
  top = TRUE
) %>% align(align = "left", part = "header")
```

Table 9. PCLR results of each age phase. Acc. = Accuracy, AAD. = Average
absolute deviation (Year), Accuracy is in percent (%) and Bias, AAD are
in years


```{r, warning = FALSE, message = FALSE}
LR_C_Total_Test <-
  data.frame(round(prop.table(table(
    PCLR_result$Accuracy
  )) * 100, 1))
LR_C_Test_Ac1 <-
  data.frame(round(prop.table(
    table(PCLR_result$AgeCohort, PCLR_result$Accuracy), 1
  ) * 100, 1))
LR_C_Total_Test2 <- rbind(LR_C_Total_Test[1, ], LR_C_Test_Ac1[1:7, -2])
LR_BTest <- data.frame(as.numeric(PCLR_result$Mean))
LR_BTest[, 2] <-
  LR_BTest$as.numeric.PCLR_result.Mean. - PCLR_result$PCLR_Test.Age
LR_C_BTable <- cbind(LR_BTest, PCLR_result$AgeCohort)
LR_C_BTable[, 4] = abs(LR_C_BTable$V2)
names(LR_C_BTable) = c("Mean", "Bias", "Cohort", "ABS")
LR_C_BiasTable <-
  round(aggregate(LR_C_BTable[, 2], list(LR_C_BTable$Cohort), mean), 2)
LR_C_ABSTable <-
  round(aggregate(LR_C_BTable[, 4], list(LR_C_BTable$Cohort), mean), 2)
LR_C_TotalBias <- data.frame("Total", round(mean(LR_C_BTable$Bias), 2))
names(LR_C_TotalBias) = c("Group.1", "x")
LR_C_TotalABS <- data.frame("Total", round(mean(LR_C_BTable$ABS), 2))
names(LR_C_TotalABS) = c("Group.1", "x")
LR_C_TotalABS2 <- rbind(LR_C_TotalABS, LR_C_ABSTable)
LR_C_TotalBias2 <- rbind(LR_C_TotalBias, LR_C_BiasTable)
LR_C_Total_Test3 <-
  cbind(LR_C_Total_Test2, LR_C_TotalBias2, LR_C_TotalABS2)
LR_C_Total_Test3 <- subset(LR_C_Total_Test3, select = -c(Group.1))
LR_C_Total_Test3 <- subset(LR_C_Total_Test3, select = -c(Group.1))
LR_C_Total_Test3[, 1] = c("Total", "20s", "30s", "40s", "50s", "60s", "70s", "Over80")
names(LR_C_Total_Test3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
LR_C_Total_Train <-
  data.frame(round(prop.table(table(
    Train_PCLR_result$Accuracy
  )) * 100, 1))
LR_C_Train_Ac1 <-
  data.frame(round(prop.table(
    table(Train_PCLR_result$AgeCohort, Train_PCLR_result$Accuracy),
    1
  ) * 100, 1))
LR_C_Total_Train2 <-
  rbind(LR_C_Total_Train[1, ], LR_C_Train_Ac1[1:7, -2])
LR_BTrain <- data.frame(as.numeric(Train_PCLR_result$Mean))
LR_BTrain[, 2] <-
  LR_BTrain$as.numeric.Train_PCLR_result.Mean. - Train_PCLR_result$PCLR_Train.Age
LR_CTrain_BTable <- cbind(LR_BTrain, Train_PCLR_result$AgeCohort)
LR_CTrain_BTable[, 4] = abs(LR_CTrain_BTable$V2)
names(LR_CTrain_BTable) = c("Mean", "Bias", "Cohort", "ABS")
LR_CTrain_BiasTable <-
  round(aggregate(LR_CTrain_BTable[, 2], list(LR_CTrain_BTable$Cohort), mean), 2)
LR_CTrain_ABSTable <-
  round(aggregate(LR_CTrain_BTable[, 4], list(LR_CTrain_BTable$Cohort), mean), 2)
LR_CTrain_TotalBias <-
  data.frame("Total", round(mean(LR_CTrain_BTable$Bias), 2))
names(LR_CTrain_TotalBias) = c("Group.1", "x")
LR_CTrain_TotalABS <-
  data.frame("Total", round(mean(LR_CTrain_BTable$ABS), 2))
names(LR_CTrain_TotalABS) = c("Group.1", "x")
LR_CTrain_TotalABS2 <- rbind(LR_CTrain_TotalABS, LR_CTrain_ABSTable)
LR_CTrain_TotalBias2 <- rbind(LR_CTrain_TotalBias, LR_CTrain_BiasTable)
LR_C_Total_Train3 <-
  cbind(LR_C_Total_Train2, LR_CTrain_TotalBias2, LR_CTrain_TotalABS2)
LR_C_Total_Train3 <- subset(LR_C_Total_Train3, select = -c(Group.1))
LR_C_Total_Train3 <- subset(LR_C_Total_Train3, select = -c(Group.1))
LR_C_Total_Train3[, 1] = c("Total", "20s", "30s", "40s", "50s", "60s", "70s", "Over80")
names(LR_C_Total_Train3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
LR_C_Total_Total <-
  data.frame(round(prop.table(table(
    Total_PCLR_result$Accuracy
  )) * 100, 1))
LR_C_Total_Ac1 <-
  data.frame(round(prop.table(
    table(Total_PCLR_result$AgeCohort, Total_PCLR_result$Accuracy),
    1
  ) * 100, 1))
LR_C_Total_Total2 <-
  rbind(LR_C_Total_Total[1, ], LR_C_Total_Ac1[1:7, -2])
LR_BTotal <- data.frame(as.numeric(Total_PCLR_result$Mean))
LR_BTotal[, 2] <-
  LR_BTotal$as.numeric.Total_PCLR_result.Mean. - Total_PCLR_result$PCLR_data.Age
LR_CTotal_BTable <- cbind(LR_BTotal, Total_PCLR_result$AgeCohort)
LR_CTotal_BTable[, 4] = abs(LR_CTotal_BTable$V2)
names(LR_CTotal_BTable) = c("Mean", "Bias", "Cohort", "ABS")
LR_CTotal_BiasTable <-
  round(aggregate(LR_CTotal_BTable[, 2], list(LR_CTotal_BTable$Cohort), mean), 2)
LR_CTotal_ABSTable <-
  round(aggregate(LR_CTotal_BTable[, 4], list(LR_CTotal_BTable$Cohort), mean), 2)
LR_CTotal_TotalBias <-
  data.frame("Total", round(mean(LR_CTotal_BTable$Bias), 2))
names(LR_CTotal_TotalBias) = c("Group.1", "x")
LR_CTotal_TotalABS <-
  data.frame("Total", round(mean(LR_CTotal_BTable$ABS), 2))
names(LR_CTotal_TotalABS) = c("Group.1", "x")
LR_CTotal_TotalABS2 <- rbind(LR_CTotal_TotalABS, LR_CTotal_ABSTable)
LR_CTotal_TotalBias2 <- rbind(LR_CTotal_TotalBias, LR_CTotal_BiasTable)
LR_C_Total_Total3 <-
  cbind(LR_C_Total_Total2, LR_CTotal_TotalBias2, LR_CTotal_TotalABS2)
LR_C_Total_Total3 <- subset(LR_C_Total_Total3, select = -c(Group.1))
LR_C_Total_Total3 <- subset(LR_C_Total_Total3, select = -c(Group.1))
LR_C_Total_Total3[, 1] = c("Total", "20s", "30s", "40s", "50s", "60s", "70s", "Over80")
names(LR_C_Total_Total3) = c("", "Acc.", "Bias.", "AAD.")
```

```{r, warning = FALSE, message = FALSE}
LR_C_PCLR_result_Table <-
  cbind(LR_C_Total_Test3, LR_C_Total_Train3, LR_C_Total_Total3)
LR_C_PCLR_result_Table <-
  subset(LR_C_PCLR_result_Table, select = -c(Var.5, Var.9))
LR_C_PCLR_result_Table %>% flextable() %>% autofit() %>% add_header_row(
  values = c(
    " ",
    "ACC.",
    "Bias",
    "AAD.",
    "ACC.",
    "Bias",
    "AAD.",
    "ACC.",
    "Bias",
    "AAD."
  ),
  top = FALSE
) %>% theme_box() %>% delete_rows(i = 1, part = "header") %>% add_header_row(
  values = c(" ", "Test set", "Train set", "Combined set"),
  colwidths = c(1, 3, 3, 3),
  top = TRUE
) %>% align(align = "left", part = "header")
```

Table 10. PCLR results within 10-year intervals. Acc. = Accuracy, AAD. =
Average absolute deviation (Year), Accuracy is in percent (%) and Bias,
AAD are in years


### Discussion

Initial analyses involving the DNE values and known age-at-death revealed ten 
DNE variables that were highly correlated with age (Table 3 and Figure 3). 
The majority of these variables had positive correlations, demonstrating that 
the auricular surface becomes more curved with increasing adult age. The only 
variable to show a negative correlation was the proportion of polygon faces 
with DNE of less than 0.0001, which demonstrates that flatter areas of the 
auricular surface (the number of polygons that are mathematically flat as a 
product of nv and nu), become reduced with increasing age as the surface 
becomes more irregular. These findings are in agreement with traditional methods 
of age estimation, which have long been aware that areas of macroporosity
and osteophytic growth become more visible on the auricular surfaces of older 
individuals (Buckberry and Chamberlain, 2002; Lovejoy et al., 1985). Previous 
research with curvature analysis has suggested that young adults have high
curvature values (Jang et al., 2024; Villa et al., 2015), a finding which is
not echoed here. It is well known that the auricular surfaces of younger adults 
display distinctive areas of transverse organization over a large proportion 
of the surface (Buckberry and Chamberlain, 2002; Lovejoy et al., 1985) and it 
was previously thought that this feature contributed to the high levels of 
curvature reported by Jang et al. (2024) and Villa et al. (2015). However, while 
transverse organization is visible on the reconstructed models used in the 
current study, it appears to have had no measurable effect on curvature. It is 
possible that results for younger adults in Jang et al. (2024) and 
Villa et al. (2015) are highly affected by the presence of subchondral defects 
(which produce very high DNE values (>0.6)). While subchondral defects are 
present in all age groups, they have a limited on impact on the variance and 
median DNE values when the sample is large. However, when the sample is small, 
the inclusion of several individuals with subchondral defects can increase the 
variance dramatically and raise median DNE values for the entire group, leading 
to improper generalisation due to the small sample size. These results 
demonstrate that variables relating to a number of the morphological, 
degenerative features used in traditional age estimation methods can be 
identified through DNE analysis. However, instead of relying on the experience 
of the observer, DNE can quantify mathematical aspects of surface geometry that 
are correlated with age, reducing the subjectivity and user-dependence.
The JSDNE R package uses DNE variables that are correlated with age-at-death 
to estimate age for unknown auricular surfaces. Three functions are available;
PCQDA, PCR, and PCLR. The total accuracy of the PCQDA function produces a high 
level of accuracy (91%), likely a result of wide age ranges of each age phase 
(Millán et al., 2013). The PCLR function also produces the highest level of 
accuracy (92.9%), but is used to determine whether an individual is under 67 
or over 63 years of age. The PCR function produces a narrower age range 
(SE: 8.8yrs) with the high level of accuracy (76%). These results are similar 
to the accuracy rates gained by the majority of researchers who carry out 
validation studies of the Buckberry and Chamberlain (94% - 86%) and Lovejoy 
(63% - 27%) methods of traditional analysis (Hughes et al., 2024; 
Milán et al., 2013; Rissech, et al., 2012). However, while the traditional 
methods rely on subjectivity and the researchers own experience in assigning 
an individual to an age phase (Štepanovský et al., 2023), the JSDNE results 
are completely objective and have excellent levels of repeatability. When 
choosing which function to use, the nature of the research must be considered. 
PCQDA and PCLR may be more suitable for estimating age in archaeological 
individuals as these functions can identify broad age ranges that correspond 
to various stages of the lifecourse with moderate to high levels of accuracy. 
For forensic cases, which require a more precise estimate of age-at-death, 
the PCR function may be more appropriate. It is also possible to use all three 
functions in conjunction with one another.
Although able to provide an objective and user-independent estimate of 
age-at-death, these results still demonstrate a degree of bias, as the 
majority of the functions tended to overestimate the age of younger 
individuals and underestimate the age of older individuals. This is a common 
tendency that has been observed in other studies (Falys et al., 2006; 
Moraitis et al., 2014; Navitainuck et al., 2022; Rissech et al., 2012; 
Rivera-Sandoval et al., 2018; Štepanovský et al., 2023), and relates to the 
age structure of skeletal samples used to develop the methods. Generally, the 
number of younger and older adults is fewer than those who are middle-aged, 
meaning that a wider range of variation is captured for the middle-aged 
auricular surfaces and the resulting age estimates are also biased towards 
this age group. There is currently no way to alleviate this problem with the 
known-age skeletal collections that are available worldwide. However, 
profile likelihood analysis could be a good alternative to reduce the 
underestimation and overestimation issue with predicted ages, albeit with 
broader prediction intervals. However, there is no R package for profile 
likelihood, so this method of analysis would have to be performed in another 
statistical programme.


### Conclusion

The present research successfully identified ten geometric variables of the 
auricular surface that were associated with known age-at-death and used these 
to create an objective, mathematical age estimation method that is available as
a novel R package, JSDNE (https://cran.r-project.org/package=JSDNE). 
The detailed code and the raw data developed the findings of this study are 
openly available at https://github.com/jisunjang19/cran-JSDNE or 
doi: 10.5281/zenodo.12708779. This estimates age using three functions which 
offers the high levels of accuracy (91-92.9%). This method does not require a 
great degree of experience to gather and interpret the results, only 
familiarity with R studio and access to a laser scanner. Moreover, the results 
be applied to research in bioarchaeology and forensic anthropology.


### Acknowledgements

We would like to appreciate to Dr. Maria Susana De Jesus Garcia with the
Luís Lopes Skeletal Collection, curated by the National Museum of
Natural History and Science (MUHNAC), in Lisbon, Portugal, Dr. Maria
Teresa Ferreira with the 21st Century Identified Skeletal Collection,
curated at the University of Coimbra, in Portugal, Dr. Mirko Mattia and
Dr. Cristina Cattaneo with the CAL Milano Cemetery Skeletal Collection,
curated at the University of Milan, in Italy, allowing to access the
collections.

### References

Biwasaka, H., Sato, K., Aoki, Y., Kato, H., Maeno, Y., Tanijiri, T.,
Fujita, S. and Dewa, K., 2013. Three dimensional surface analyses of
pubic symphyseal faces of contemporary Japanese reconstructed with 3D
digitized scanner. Legal Medicine, 15/5, pp. 264-- 268.
<doi:10.1016/j.legalmed.2013.02.003>

Botha, D., Lynnerup, N. and Steyn, M., 2019. Age estimation using bone
mineral density in South Africans. Forensic Science International.
<doi:10.1016/j.forsciint.2019.02.020>

Brooks, S. and Suchey, J. M., 1990. Skeletal age determination based on
the os pubis: A comparison of the Acsadi-Nemeskeri and Suchey-Brooks
methods. Human Evolution, 5/3, pp. 227-238.

Buckberry, J. L. and Chamberlain, A. T., 2002. Age estimation from the
auricular surface of the ilium: A revised method. American Journal of
Physical Anthropology, 119/3, pp. 231--239. <doi:10.1002/ajpa.10130>

Bunn, J. M., Boyer, D. M., Lipman, Y., St.Clair, E. M., Jernvall, J. and
Daubechies, I., 2011. Comparing Dirichlet normal surface energy of tooth
crowns, a new technique of molar shape quantification for dietary
inference, with previous methods in isolation and in combination.
American Journal of Physical Anthropology, 145/2, pp. 247-- 261.
<doi:10.1002/ajpa.21489>

Byers, S. N., 2017. Introduction to Forensic Anthropology. 5th edition.
Oxon: Routledge.

Cardoso, F.V., 2006. Brief Communication: The Collection of Identified
Human Skeletons Housed at the Bocage Museum (National Museum of Natural
History), Lisbon, Portugal. American Journal of Physical Anthropology,
129, pp. 173-173. doi: 10.1002/ajpa.20228

Cattaneo, C., Mazzarelli, D., Cappella, A., Castoldi, E., Mattia, M.,
Poppa, P., De Angelis, D., Vitello, A. and Biehler-Gomez, L., 2018. A
modern documented Italian identified skeletal of 2127 skeletons: the CAL
Milano Cemetery Skeletal Collection. Forensic Science International,
287, pp: 219.e1-219.e5. doi: 10.1016/j.forsciint.2018.03.041

Charrad, M., Ghazzali, N., Boiteau, V. and Niknafs, A., 2014. NbClust:
An R Package for Determining the Relevant Number of Clusters in a Data
Set. Journal of Statistical Software, 61/6, pp. 1--36. Avilable at:
<https://www.jstatsoft.org/v61/i06/>.

Curate, F., Navega, D., Cunha, E. and Coelho, J. O., 2022. DXAGE 2.0 -
adult age at death estimation using bone loss in the proximal femur and
the second metacarpal. International Journal of Legal Medicine, 136/5.
pp. 1483-1494. doi: 10.1007/s00414-022-02840-y

Falys, C., Schutkowski, H., and Weston, D. A. 2006. Auricular surface
aging: worse than expected? A test of the revised method on a documented
historic skeletal assemblage. American Journal of Physical Anthropology,
130/4, pp. 508-513. doi: 10.1002/ajpa.20382

Ferreira, M. T., Vincente, R., Navega, D., Gonçalves, D., Curate, F. and
Cunha, E., 2014. A new forensic collection housed at the University of
Coimbra, Portugal: The 21st century identified skeletal collection.
Forensic Science International. 245, pp: 202.e1-202.e5. doi:
10.1016/j.forsciint.2014.09.021

Garvin, H. M. and Passalacqua, N. V., 2012. Current Practices by
Forensic Anthropologists in Adult Skeletal Age Estimation. Journal of
Forensic Sciences, 57/2, pp. 427--433.
<doi:10.1111/j.1556-4029.2011.01979.x>

Godfrey, L. R., Winchester, J. M., King, S. J., Boyer, D. M. and
Jernvall, J., 2012. Dental topography indicates ecological contraction
of lemur communities. American Journal of Physical Anthropology, 148/2,
pp. 215-227. <doi:10.1002/ajpa.21615>

Hughes, C., Yim, A.-D. and Juarez, C., 2023. Considerations for age
estimation accuracy: Method-derived outcomes and practitioner
interpretations. Journal of Forensic Science, 00, pp:1-10. doi:
10.1111/1556-4029.15505 Işcan, M. Y. and Loth, S. R., 1989. Osteological
manifestations of age in the adult. In M. Y. Iscan and L. A. R. Kennedy
(eds.): Skeletal biology of past peoples: research methods. New York:
Wiley-Liss. pp. 189-224.

Jang, J., Mariconti, E., and Watts, R., 2024. Technical note: Analysis
of the auricular surface for age estimation using dirichlet normal
energy, Forensic Imaging. 36. doi: 10.1016/j.fri.2024.200579

Kumar, C.L. and Sridhar, M. S., 1990. Estimation of the age of an
individual based on times of eruption of permanent teeth, Forensic
Science International, 48/1, pp. 1-7. doi: 10.1016/0379-0738(90)90266-2.

Lovejoy, C. O., Meindl, R. S., Pryzbeck, T. R. and Mensforth, R. P.,
1985. Chronological metamorphosis of the auricular surface of the ilium:
A new method for the determination of adult skeletal age at death.
American Journal of Physical Anthropology, 68/1, pp. 15--28.
<doi:10.1002/ajpa.1330680103>

Márquez-Grant, N., 2015. An overview of age estimation in forensic
anthropology: perspectives and practical considerations. Annals of Human
Biology, 42/4. pp. 308-322. doi: 10.3109/03014460.2015.1048288

Millán, M. S., Rissech, C.; Turbón, D., 2013. A test of Suchey--Brooks
(pubic symphysis) and Buckberry--Chamberlain (auricular surface) methods
on an identified Spanish sample: paleodemographic implications. Journal
of Archaeological Science, 40/4, pp. 1743--1751.
<doi:10.1016/j.jas.2012.11.021>

Mensforth, 1990. Paleodemography of the Carlston Annis (Bt-5) Late
Archaic skeletal population. American Journal of Physical Anthropology,
82/1, pp. 81-99. doi: 10.1002/ajpa.1330820110

Miranker, M., 2016. A Comparison of Different Age Estimation Methods of
the Adult Pelvis. Journal of Forensic Sciences, 61/5, pp. 1173--1179.
<doi:10.1111/1556-> 4029.13130

Moraitis, K., Zorba, E., Eliopoulos, C. and Fox, S. C. 2014. A Test of
the Revised Auricular Surface Aging Method on a Modern European
Population. Journal of Forensic Sciences, 59/1, pp. 188--194.
<doi:10.1111/1556-4029.12303>

Navitainuck, D. U., Vach, W., Pichler, S. L., and Alt, K. W., 2022.
Age-at-death estimation in archaeological samples: Differences in
population means resulting from different aging methods can be predicted
from the mean ages of method-specific reference samples. International
Journal of Osteoarchaeology, 32/6, pp. 1226-1237. doi: 10.1002/oa.3157

Pampush, J. D., Winchester, J. M., Morse, P. E., Vining, A. Q., Boyer,
D. M. and Kay, R. F., 2016. Introducing molaR: a New R Package for
Quantitative Topographic Analysis of Teeth (and Other Topographic
Surfaces). Journal of Mammalian Evolution, 23/4, pp. 397--412.
<doi:10.1007/s10914-016-9326-0>

Venables, W. N. and Ripley, B. D., 2002. Modern Applied Statistics with
S, 4th edition, New York: Springer. Available at:
<https://www.stats.ox.ac.uk/pub/MASS4/>.

R Core Team., 2024. R: A language and environment for statistical
computing. Vienna, Austria: R Foundation for Statistical Computing. URL
<http://www.R-project.org/>.

Rissech, C., Wilson, J., Winburn, A. P., Turbón, D. and Steadman, D.,
2012. A comparison of three established age estimation methods on an
adult Spanish sample. International Journal of Legal Medicine, 126/1,
pp. 145--155. <doi:10.1007/s00414-011-0586-1>

Rivera-Sandoval., J., Monsalve, T., and Cattaneo, C. 2018. A test of
four innominate bone age assessment methods in a modern skeletal
collection from Medellin, Colombia. Forensic Science International, 282:
232.e1-232.e8.

Schlager, S., 2017. Morpho and Rvcg -- Shape Analysis in R. In G. Zheng,
S. Li, G. Szekely (eds.), Statistical Shape and Deformation Analysis,
pp. 217--256. Massachusetts: Academic Press.

Schmeling, A., Schulz, R., Reisinger, W., Mühler, M., Wernecke, K.-D.
and Geserick, G., 2004. Studies on the time frame for ossification of
the medial clavicular epiphyseal cartilage in conventional radiography.
International Journal of Legal Medicine, 118/1, pp. 5--8.
<doi:10.1007/s00414-003-0404-5>

Schwartz, J. H., 1995. Skeletal keys an introduction to human skeletal
morphology, development, and analysis. New York: Oxford University Press

Slice, D. E. and Algee-Hewitt, B. F. B. 2015. Modeling Bone Surface
Morphology: A Fully Quantitative Method for Age-at-Death Estimation
Using the Pubic Symphysis. Journal of Forensic Sciences, 60/4, pp.
835--843. <doi:10.1111/1556-4029.12778>

Štepanovský, M., Buk, Z., Kotěrová, A. P., Brůžek, J., Bejdová, Š.,
Techataweewan, N. and Velemínská, J. 2023. Automated age‐at‐death
estimation from 3D surface scans of the facies auricularis of the pelvic
bone. Forensic Science International, 349,
<doi:10.1016/j.forsciint.2023.111765>

Stoyanova, D., Algee-Hewitt, B. F. B., Slice, D. E. 2015. An enhanced
computational method for age-at-death estimation based on the pubic
symphysis using 3D laser scans and thin plate splines. American Journal
of Physical Anthropology, 158/3, pp. 431--440. <doi:10.1002/ajpa.22797>

Stoyanova, D. K., Algee-Hewitt, B. F. B., Kim, J. and Slice D. E., 2017.
A Computational Framework for Age-at-Death Estimation from the Skeleton:
Surface and Outline Analysis of 3D Laser Scans of the Adult Pubic
Symphysis. Journal of Forensic Sciences, 62/6, pp. 1434-1444.
<doi:10.1111/1556-4029.13439>

Villa, C., Buckberry, J., Cattaneo, C., Frohlich, B. and Lynnerup, N.,
2015. Quantitative Analysis of the Morphological Changes of the Pubic
Symphyseal Face and the Auricular Surface and Implications for Age at
Death Estimation. Journal of Forensic Sciences, 60/3, pp. 556--565.
<doi:10.1111/1556-4029.12689>

Warrier, V., Shedge, R., Garg, P. K., Dixit, S. G., Krishan, K. and
Kanchan, T., 2023. Age estimation from iliac auricular surface using
Bayesian inference and principal component analysis: a CT-based study in
an Indian population. Forensic Science, Medicine and Pathology. doi:
10.1007/s12024-023-00637-y

Wickham H., Averick M., Bryan J., Chang W., McGowan L. D., François R.,
Grolemund G., Hayes A., Henry L., Hester J., Kuhn M., Pedersen T. L.,
Miller E., Bache S. M., Müller K., Ooms J., Robinson D., Seidel D. P.,
Spinu V., Takahashi K., Vaughan D., Wilke C., Woo K. and Yutani H.,
2019. Welcome to the tidyverse. Journal of Open Source Software, 4/43,
1686. <doi:10.21105/joss.01686>.

Winchester, J. M., Boyer, D. M., St. Clair, E. M., Gosselin-Ildari, A.
D., Cooke, S. B. and Ledogar, J. A. 2014. Dental topography of
platyrrhines and prosimians: Convergence and contrasts. American Journal
of Physical Anthropology, 153/1, pp. 29--44. <doi:10.1002/ajpa.2239>

Zhang, Y., Wang, Z., Liao, Y., Li, T., Xu, X., Wu, W., Zhou, J., Huang,
W., Luo, S. and Chen, F., 2022. A machine-learning approach using pubic
CT based on radiomics to estimate adult ages. European Journal of
Radiology. doi: 10.1016/j.ejrad.2022.110516
